<!DOCTYPE html>
<!--[if IE 8]><html lang="en" dir="ltr" class="ie8"><![endif]-->
<!--[if IE 9]><html lang="en" dir="ltr" class="ie9"><![endif]-->
<!--[if gt IE 9]><!-->
<html dir="ltr" class="js no-touch localstorage sessionstorage contenteditable use-opacity-transitions" lang="en"><!--<![endif]--><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <title>Disqus Comments</title>

    
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <style>
        .alert--warning {
            border-radius: 3px;
            padding: 10px 15px;
            margin-bottom: 10px;
            background-color: #FFE070;
            color: #A47703;
        }

        .alert--warning a,
        .alert--warning a:hover,
        .alert--warning strong {
            color: #A47703;
            font-weight: bold;
        }

        .alert--error p,
        .alert--warning p {
            margin-top: 5px;
            margin-bottom: 5px;
        }
        
        </style>
    
    <style>
        
        html {
            overflow: hidden;
        }
        

        #error {
            display: none;
        }

        .clearfix:after {
            content: "";
            display: block;
            height: 0;
            clear: both;
            visibility: hidden;
        }

        
    </style>

<script crossorigin="anonymous" id="bootstrap-script" data-app="lounge" src="a_data/lounge_002.js"></script><meta http-equiv="Content-Security-Policy" content="script-src https:;"><link rel="stylesheet" href="a_data/lounge.css"><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="lounge/main" src="a_data/lounge.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="remote/config" src="a_data/config.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="ga" src="a_data/ga.js"></script><style id="css_1509618886931"></style><!-- base href="https://disqus.com/embed/comments/?base=default&f=pentestblog&t_i=454%20https%3A%2F%2Fpentest.blog%2F%3Fp%3D454&t_u=https%3A%2F%2Fpentest.blog%2Fwindows-privilege-escalation-methods-for-pentesters%2F&t_e=Windows%20Privilege%20Escalation%20Methods%20for%20Pentesters&t_d=Windows%20Privilege%20Escalation%20Methods%20for%20Pentesters&t_t=Windows%20Privilege%20Escalation%20Methods%20for%20Pentesters&s_o=default&l=" --></head>
<body>
    

    
    <div id="error" class="alert--error">
        <p>We were unable to load Disqus. If you are a moderator please see our <a href="https://docs.disqus.com/help/83/"> troubleshooting guide</a>. </p>
    </div>

    
    <script type="text/json" id="disqus-forumData">{"session":{"canModerate":false,"audienceSyncVerified":false,"mustVerify":false,"canReply":true,"mustVerifyEmail":false},"forum":{"aetBannerConfirmation":null,"founder":"56267343","twitterName":"pentestblog","commentsLinkOne":"1 Comment","guidelines":null,"favicon":{"permalink":"https://disqus.com/api/forums/favicons/pentestblog.jpg","cache":"//a.disquscdn.com/1509064866/images/favicon-default.png"},"commentsLinkZero":"0 Comments","disableDisqusBranding":false,"daysAlive":0,"createdAt":"2016-12-16T04:57:38.866415","category":"Tech","aetBannerEnabled":false,"aetBannerTitle":null,"raw_guidelines":null,"colorScheme":"light","id":"pentestblog","installCompleted":true,"commentPolicyText":null,"aetEnabled":false,"channel":null,"sort":4,"description":"\u003cp>The \u003ca href=\"https://disq.us/url?url=https%3A%2F%2Fpentest.blog%3AjwmdeV37-dTJiqKvjKAu6hqUkPU&amp;cuid=4765649\" rel=\"nofollow noopener\" title=\"https://pentest.blog\">https://pentest.blog\u003c/a> was set up by a bunch of people, who are friend in real life, for the purpose of explaining the experiences gained during penetration test.\u003c/p>","moderatorBadgeText":"Ninja","raw_description":"The https://pentest.blog was set up by a bunch of people, who are friend in real life, for the purpose of explaining the experiences gained during penetration test.","language":"en","adsReviewStatus":0,"pk":"4765649","forumCategory":{"date_added":"2016-01-28T01:54:31","id":8,"name":"Tech"},"permissions":{},"commentPolicyLink":null,"aetBannerDescription":null,"name":"Pentest Blog - Inn for security folks","commentsLinkMultiple":"{num} Comments","settings":{"adsDRNativeEnabled":false,"disable3rdPartyTrackers":true,"adsVideoEnabled":false,"adsProductVideoEnabled":false,"adsPositionTopEnabled":false,"ssoRequired":false,"unapproveLinks":false,"adsEnabled":false,"adsProductLinksThumbnailsEnabled":false,"hasCustomAvatar":false,"organicDiscoveryEnabled":false,"allowMedia":true,"adsProductDisplayEnabled":false,"adsProductLinksEnabled":false,"linkAffiliationEnabled":false,"allowAnonPost":true,"adsProductStoriesEnabled":false,"adultContent":false,"allowAnonVotes":false,"mustVerify":true,"mustVerifyEmail":true,"audienceSyncEnabled":false,"mediaembedEnabled":true,"adsPositionBottomEnabled":false,"discoveryLocked":false,"validateAllPosts":false,"adsSettingsLocked":false,"isVIP":false,"adsPositionInthreadEnabled":false},"organizationId":2478362,"typeface":"sans-serif","url":"https://pentest.blog","daysThreadAlive":0,"avatar":{"small":{"permalink":"https://disqus.com/api/forums/avatars/pentestblog.jpg?size=32","cache":"//a.disquscdn.com/1509064866/images/noavatar32.png"},"large":{"permalink":"https://disqus.com/api/forums/avatars/pentestblog.jpg?size=92","cache":"//a.disquscdn.com/1509064866/images/noavatar92.png"}},"signedUrl":"https://disq.us/?url=https%3A%2F%2Fpentest.blog&key=RM22Kj5HREnnrOqb-2sCmA"}}</script>

    <script type="text/json" id="disqus-threadData">{"cursor":{"hasPrev":false,"prev":null,"total":24,"hasNext":false,"next":"1:0:0"},"code":0,"response":{"lastModified":1508932973,"posts":[{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Brilliant article , favorited\u003cbr>I dont agree with this '|findstr /i \"Auto\"' in the first technique. If I m correct you can hijack automaticaly started service, if their path is vulnerable. Why would you remove them from the list ?\u003c/p>","id":"3576011818","isHighlighted":false,"author":{"name":"qdqdqsdsq","url":"","profileUrl":"","emailHash":"","avatar":{"small":{"permalink":"//a.disquscdn.com/1509064866/images/noavatar32.png","cache":"//a.disquscdn.com/1509064866/images/noavatar32.png"},"large":{"permalink":"//a.disquscdn.com/1509064866/images/noavatar92.png","cache":"//a.disquscdn.com/1509064866/images/noavatar92.png"},"permalink":"//a.disquscdn.com/1509064866/images/noavatar92.png","cache":"//a.disquscdn.com/1509064866/images/noavatar92.png"},"signedUrl":"","isAnonymous":true},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-10-20T08:59:38","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Brilliant article , favorited\nI dont agree with this '|findstr /i \"Auto\"' in the first technique. If I m correct you can hijack automaticaly started service, if their path is vulnerable. Why would you remove them from the list ?","canVote":false,"thread":"6115200593","forum":"pentestblog","depth":0,"points":0,"moderationLabels":["anonymous"],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>I didn't get your question. Yes, we are trying to list automatically started vulnerable services. That's why we use '|findstr /i \"Auto\"'.\u003c/p>","id":"3583800976","isHighlighted":false,"author":{"username":"gokhansagoglu","about":"","name":"Gokhan Sagoglu","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2017-09-02T20:51:46","profileUrl":"https://disqus.com/by/gokhansagoglu/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"264020658","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/gokhansagoglu.jpg","cache":"https://c.disquscdn.com/uploads/users/26402/658/avatar32.jpg?1508932973"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/gokhansagoglu.jpg","cache":"https://c.disquscdn.com/uploads/users/26402/658/avatar92.jpg?1508932973","large":{"permalink":"https://disqus.com/api/users/avatars/gokhansagoglu.jpg","cache":"https://c.disquscdn.com/uploads/users/26402/658/avatar92.jpg?1508932973"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-10-25T12:02:52","parent":3576011818,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"I didn't get your question. Yes, we are trying to list automatically started vulnerable services. That's why we use '|findstr /i \"Auto\"'.","canVote":false,"thread":"6115200593","forum":"pentestblog","depth":1,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Fantastic! I love this post. Narrated it so clearly. I learned a lot! Bookmarked.\u003c/p>","id":"3558064823","isHighlighted":false,"author":{"username":"xiaohangyu","about":"","name":"Xiaohang Yu","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2017-01-13T16:31:34","profileUrl":"https://disqus.com/by/xiaohangyu/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"238616732","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/xiaohangyu.jpg","cache":"//a.disquscdn.com/1509064866/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/xiaohangyu.jpg","cache":"//a.disquscdn.com/1509064866/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/xiaohangyu.jpg","cache":"//a.disquscdn.com/1509064866/images/noavatar92.png"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-10-09T04:07:19","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Fantastic! I love this post. Narrated it so clearly. I learned a lot! Bookmarked.","canVote":false,"thread":"6115200593","forum":"pentestblog","depth":0,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Awesome post, thank you! Bookmarked.\u003c/p>","id":"3499312098","isHighlighted":false,"author":{"name":"Christophe","url":"","profileUrl":"","emailHash":"","avatar":{"small":{"permalink":"//a.disquscdn.com/1509064866/images/noavatar32.png","cache":"//a.disquscdn.com/1509064866/images/noavatar32.png"},"large":{"permalink":"//a.disquscdn.com/1509064866/images/noavatar92.png","cache":"//a.disquscdn.com/1509064866/images/noavatar92.png"},"permalink":"//a.disquscdn.com/1509064866/images/noavatar92.png","cache":"//a.disquscdn.com/1509064866/images/noavatar92.png"},"signedUrl":"","isAnonymous":true},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-08-31T15:41:56","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Awesome post, thank you! Bookmarked.","canVote":false,"thread":"6115200593","forum":"pentestblog","depth":0,"points":0,"moderationLabels":["anonymous"],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Thanks for taking the time to wrote this article, very helpful! I'm your follower now :)\u003c/p>","id":"3499312096","isHighlighted":false,"author":{"name":"PlainText","url":"","profileUrl":"","emailHash":"","avatar":{"small":{"permalink":"//a.disquscdn.com/1509064866/images/noavatar32.png","cache":"//a.disquscdn.com/1509064866/images/noavatar32.png"},"large":{"permalink":"//a.disquscdn.com/1509064866/images/noavatar92.png","cache":"//a.disquscdn.com/1509064866/images/noavatar92.png"},"permalink":"//a.disquscdn.com/1509064866/images/noavatar92.png","cache":"//a.disquscdn.com/1509064866/images/noavatar92.png"},"signedUrl":"","isAnonymous":true},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-08-09T13:33:07","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Thanks for taking the time to wrote this article, very helpful! I'm your follower now :)","canVote":false,"thread":"6115200593","forum":"pentestblog","depth":0,"points":0,"moderationLabels":["anonymous"],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Hi, one the best guides out there ;)\u003c/p>\u003cp>Two things: \u003cbr>1. on the command below, you need to modify the start=auto to start= auto (space after the equal sign).\u003cbr>C:\\Windows\\System32&gt;sc create \"Vulnerable Service\" binPath= \"C:\\Program Files (x86)\\Program Folder\\A Subfolder\\Executable.exe\" start= auto\u003c/p>\u003cp>2. I tried to follow the insecure registery file path mofication and the service path modification, but it gives me errors about access denied when I use the SubInACL  or the sc config command.\u003c/p>\u003cp>Would you be so kind and tell how to prepare the vulnerable service in order to simulate a successfull attack on lab?\u003c/p>","id":"3499312091","isHighlighted":false,"author":{"name":"Ibrahim","url":"","profileUrl":"","emailHash":"","avatar":{"small":{"permalink":"//a.disquscdn.com/1509064866/images/noavatar32.png","cache":"//a.disquscdn.com/1509064866/images/noavatar32.png"},"large":{"permalink":"//a.disquscdn.com/1509064866/images/noavatar92.png","cache":"//a.disquscdn.com/1509064866/images/noavatar92.png"},"permalink":"//a.disquscdn.com/1509064866/images/noavatar92.png","cache":"//a.disquscdn.com/1509064866/images/noavatar92.png"},"signedUrl":"","isAnonymous":true},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-06-10T15:47:19","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Hi, one the best guides out there ;)\n\nTwo things: \n1. on the command below, you need to modify the start=auto to start= auto (space after the equal sign).\nC:\\Windows\\System32&#62;sc create \"Vulnerable Service\" binPath= \"C:\\Program Files (x86)\\Program Folder\\A Subfolder\\Executable.exe\" start= auto\n\n2. I tried to follow the insecure registery file path mofication and the service path modification, but it gives me errors about access denied when I use the SubInACL  or the sc config command. \n\nWould you be so kind and tell how to prepare the vulnerable service in order to simulate a successfull attack on lab?","canVote":false,"thread":"6115200593","forum":"pentestblog","depth":0,"points":0,"moderationLabels":["anonymous"],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>1. Adding space after equal sign is unnecessary. Command works fine in this way. But it may vary depending on the operating system version. Which version of Windows are you using?\u003c/p>\u003cp>2. If you want to modify a registry value with unprivileged user, the registry key should has proper permissions. You may consider simply granting full control for everyone:\u003c/p>\u003cp>\u003cem>subinacl /subkeyreg \"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Vulnerable Service\" /grant=Everyone=F\u003c/em>\u003c/p>","id":"3499312142","isHighlighted":false,"author":{"name":"Gokhan Sagoglu","url":"","profileUrl":"","emailHash":"","avatar":{"small":{"permalink":"//a.disquscdn.com/1509064866/images/noavatar32.png","cache":"//a.disquscdn.com/1509064866/images/noavatar32.png"},"large":{"permalink":"//a.disquscdn.com/1509064866/images/noavatar92.png","cache":"//a.disquscdn.com/1509064866/images/noavatar92.png"},"permalink":"//a.disquscdn.com/1509064866/images/noavatar92.png","cache":"//a.disquscdn.com/1509064866/images/noavatar92.png"},"signedUrl":"","isAnonymous":true},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-06-11T15:01:47","parent":3499312091,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"1. Adding space after equal sign is unnecessary. Command works fine in this way. But it may vary depending on the operating system version. Which version of Windows are you using?\n\n2. If you want to modify a registry value with unprivileged user, the registry key should has proper permissions. You may consider simply granting full control for everyone:\n\n\u003cem>subinacl /subkeyreg \"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Vulnerable Service\" /grant=Everyone=F\u003c/em>","canVote":false,"thread":"6115200593","forum":"pentestblog","depth":1,"points":0,"moderationLabels":["anonymous"],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>1. I used Windows 7 Ultimate 32-bit in my lab. I will give it a try on other old and recent releases.\u003cbr>2. I will do so by using the provided command :).\u003c/p>\u003cp>Thanks for the reply.\u003c/p>","id":"3499312264","isHighlighted":false,"author":{"name":"Ibrahim","url":"","profileUrl":"","emailHash":"","avatar":{"small":{"permalink":"//a.disquscdn.com/1509064866/images/noavatar32.png","cache":"//a.disquscdn.com/1509064866/images/noavatar32.png"},"large":{"permalink":"//a.disquscdn.com/1509064866/images/noavatar92.png","cache":"//a.disquscdn.com/1509064866/images/noavatar92.png"},"permalink":"//a.disquscdn.com/1509064866/images/noavatar92.png","cache":"//a.disquscdn.com/1509064866/images/noavatar92.png"},"signedUrl":"","isAnonymous":true},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-06-11T20:27:53","parent":3499312142,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"1. I used Windows 7 Ultimate 32-bit in my lab. I will give it a try on other old and recent releases.\n2. I will do so by using the provided command :). \n\nThanks for the reply.","canVote":false,"thread":"6115200593","forum":"pentestblog","depth":2,"points":0,"moderationLabels":["anonymous"],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Hey,\u003cbr>I've got a question. Tried the first one to get the privileges!\u003c/p>\u003cp>The vulnerable path is `C:\\Program Files (x86)\\ASUS\\ATK Package\\ATK Hotkey\\AsLdrSrv.exe`\u003cbr>So I tried placing a file `C:\\Program Files (x86)\\ASUS\\ATK Package\\ATK Hotkey.exe`\u003c/p>\u003cp>But it actually doesn't work. Am I doing something wrong?\u003c/p>","id":"3499312087","isHighlighted":false,"author":{"name":"Dario Ackermann","url":"","profileUrl":"","emailHash":"","avatar":{"small":{"permalink":"//a.disquscdn.com/1509064866/images/noavatar32.png","cache":"//a.disquscdn.com/1509064866/images/noavatar32.png"},"large":{"permalink":"//a.disquscdn.com/1509064866/images/noavatar92.png","cache":"//a.disquscdn.com/1509064866/images/noavatar92.png"},"permalink":"//a.disquscdn.com/1509064866/images/noavatar92.png","cache":"//a.disquscdn.com/1509064866/images/noavatar92.png"},"signedUrl":"","isAnonymous":true},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-04-25T16:16:48","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Hey,\nI've got a question. Tried the first one to get the privileges!\n\nThe vulnerable path is `C:\\Program Files (x86)\\ASUS\\ATK Package\\ATK Hotkey\\AsLdrSrv.exe`\nSo I tried placing a file `C:\\Program Files (x86)\\ASUS\\ATK Package\\ATK Hotkey.exe`\n\nBut it actually doesn't work. Am I doing something wrong?","canVote":false,"thread":"6115200593","forum":"pentestblog","depth":0,"points":0,"moderationLabels":["anonymous"],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>You're doing it wrong. You should place the executable to one of these paths:\u003cbr>\u003cem>C:\\Program Files (x86)\\ASUS\\ATK Package\\ATK.exe\u003c/em>\u003cbr>\u003cem>C:\\Program Files (x86)\\ASUS\\ATK.exe\u003c/em>\u003cbr>\u003cem>C:\\Program Files.exe\u003c/em>\u003cbr>\u003cem>C:\\Program.exe\u003c/em>\u003c/p>","id":"3499312110","isHighlighted":false,"author":{"name":"Gokhan Sagoglu","url":"","profileUrl":"","emailHash":"","avatar":{"small":{"permalink":"//a.disquscdn.com/1509064866/images/noavatar32.png","cache":"//a.disquscdn.com/1509064866/images/noavatar32.png"},"large":{"permalink":"//a.disquscdn.com/1509064866/images/noavatar92.png","cache":"//a.disquscdn.com/1509064866/images/noavatar92.png"},"permalink":"//a.disquscdn.com/1509064866/images/noavatar92.png","cache":"//a.disquscdn.com/1509064866/images/noavatar92.png"},"signedUrl":"","isAnonymous":true},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-04-25T17:14:24","parent":3499312087,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"You're doing it wrong. You should place the executable to one of these paths:\n\u003cem>C:\\Program Files (x86)\\ASUS\\ATK Package\\ATK.exe\u003c/em>\n\u003cem>C:\\Program Files (x86)\\ASUS\\ATK.exe\u003c/em>\n\u003cem>C:\\Program Files.exe\u003c/em>\n\u003cem>C:\\Program.exe\u003c/em>","canVote":false,"thread":"6115200593","forum":"pentestblog","depth":1,"points":0,"moderationLabels":["anonymous"],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Great Article !\u003cbr>I have one question, how would you query the registry for all services with Insecure Registry Permissions ? In the example you already know about the weak one.\u003cbr>Regards,\u003c/p>","id":"3499312080","isHighlighted":false,"author":{"name":"fahad","url":"","profileUrl":"","emailHash":"","avatar":{"small":{"permalink":"//a.disquscdn.com/1509064866/images/noavatar32.png","cache":"//a.disquscdn.com/1509064866/images/noavatar32.png"},"large":{"permalink":"//a.disquscdn.com/1509064866/images/noavatar92.png","cache":"//a.disquscdn.com/1509064866/images/noavatar92.png"},"permalink":"//a.disquscdn.com/1509064866/images/noavatar92.png","cache":"//a.disquscdn.com/1509064866/images/noavatar92.png"},"signedUrl":"","isAnonymous":true},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-03-07T10:48:49","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Great Article !\nI have one question, how would you query the registry for all services with Insecure Registry Permissions ? In the example you already know about the weak one.\nRegards,","canVote":false,"thread":"6115200593","forum":"pentestblog","depth":0,"points":0,"moderationLabels":["anonymous"],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Instead of typing service name you should put \"*\" for listing all service's permissions:\u003c/p>\u003cp>\u003ccode>subinacl.exe /keyreg \"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\*\" /display\u003c/code>\u003c/p>","id":"3499312086","isHighlighted":false,"author":{"name":"Gokhan Sagoglu","url":"","profileUrl":"","emailHash":"","avatar":{"small":{"permalink":"//a.disquscdn.com/1509064866/images/noavatar32.png","cache":"//a.disquscdn.com/1509064866/images/noavatar32.png"},"large":{"permalink":"//a.disquscdn.com/1509064866/images/noavatar92.png","cache":"//a.disquscdn.com/1509064866/images/noavatar92.png"},"permalink":"//a.disquscdn.com/1509064866/images/noavatar92.png","cache":"//a.disquscdn.com/1509064866/images/noavatar92.png"},"signedUrl":"","isAnonymous":true},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-03-09T15:55:03","parent":3499312080,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Instead of typing service name you should put \"*\" for listing all service's permissions:\n\n\u003ccode>subinacl.exe /keyreg \"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\*\" /display\u003c/code>","canVote":false,"thread":"6115200593","forum":"pentestblog","depth":1,"points":0,"moderationLabels":["anonymous"],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Hello!\u003cbr>You forgot to mention that the first low-privileged meterpreter shell has  to be launched from an interactive session (cmd.exe on remote computer) otherwise it won't work.  For example, if you launch it from an xp_cmdshell obtained by an SQLi , you will get this message: \u003cbr>\"The Windows Installer Service could not be accessed. \u003cbr>This can occur if the Windows Installer is not correctly installed. \u003cbr>Contact your support personnel for assistance.\"\u003cbr>And the detailed  log will tell you why:\u003cbr>\"Client-side and UI is none or basic: Running entire install on the server.\"\u003cbr>I wrote a similar article on my blog: \u003ca href=\"https://disq.us/url?url=https%3A%2F%2Fdecoder.cloud%3AGiudZOepwPLTlnj_FHaxnUUMH70&amp;cuid=4765649\" rel=\"nofollow noopener\" title=\"https://decoder.cloud\">https://decoder.cloud\u003c/a>\u003c/p>","id":"3499312082","isHighlighted":false,"author":{"name":"Decoder","url":"https://decoder.cloud/","profileUrl":"","emailHash":"","avatar":{"small":{"permalink":"//a.disquscdn.com/1509064866/images/noavatar32.png","cache":"//a.disquscdn.com/1509064866/images/noavatar32.png"},"large":{"permalink":"//a.disquscdn.com/1509064866/images/noavatar92.png","cache":"//a.disquscdn.com/1509064866/images/noavatar92.png"},"permalink":"//a.disquscdn.com/1509064866/images/noavatar92.png","cache":"//a.disquscdn.com/1509064866/images/noavatar92.png"},"signedUrl":"https://disq.us/?url=https%3A%2F%2Fdecoder.cloud%2F&key=ZDQGARWzeUTAzKQiZU3fyA","isAnonymous":true},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-02-24T17:54:18","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Hello!\nYou forgot to mention that the first low-privileged meterpreter shell has  to be launched from an interactive session (cmd.exe on remote computer) otherwise it won't work.  For example, if you launch it from an xp_cmdshell obtained by an SQLi , you will get this message: \n\"The Windows Installer Service could not be accessed. \nThis can occur if the Windows Installer is not correctly installed. \nContact your support personnel for assistance.\"\nAnd the detailed  log will tell you why:\n\"Client-side and UI is none or basic: Running entire install on the server.\"\nI wrote a similar article on my blog: https://decoder.cloud","canVote":false,"thread":"6115200593","forum":"pentestblog","depth":0,"points":0,"moderationLabels":["anonymous","links"],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>you use dir without /a, therefore, you miss hidden/system files and folders\u003c/p>\u003cp>to make sure they are included in search it should be dir c:\\*vnc.ini /s /b /a\u003c/p>\u003cp>but there's another thing, you use /b, therefore in your output you will have a file name (check if exists, basically), but you won't have a directory it resides in, making the search useless, so I suggest to omit /b\u003c/p>","id":"3499312075","isHighlighted":false,"author":{"name":"Leo","url":"http://lpine.org/","profileUrl":"","emailHash":"","avatar":{"small":{"permalink":"//a.disquscdn.com/1509064866/images/noavatar32.png","cache":"//a.disquscdn.com/1509064866/images/noavatar32.png"},"large":{"permalink":"//a.disquscdn.com/1509064866/images/noavatar92.png","cache":"//a.disquscdn.com/1509064866/images/noavatar92.png"},"permalink":"//a.disquscdn.com/1509064866/images/noavatar92.png","cache":"//a.disquscdn.com/1509064866/images/noavatar92.png"},"signedUrl":"http://disq.us/?url=http%3A%2F%2Flpine.org%2F&key=b1zwxlb_FxnZF-l0ejfNTA","isAnonymous":true},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-01-27T19:50:48","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"you use dir without /a, therefore, you miss hidden/system files and folders\n\nto make sure they are included in search it should be dir c:\\*vnc.ini /s /b /a\n\nbut there's another thing, you use /b, therefore in your output you will have a file name (check if exists, basically), but you won't have a directory it resides in, making the search useless, so I suggest to omit /b","canVote":false,"thread":"6115200593","forum":"pentestblog","depth":0,"points":0,"moderationLabels":["anonymous"],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>You right, I forgot to add /c. I updated the post.\u003c/p>\u003cp>Parameter /b not only shows file/folder name, it also shows their paths. I think it is useful when you only want to see file paths with no additional information.\u003c/p>\u003cp>Thanks.\u003c/p>","id":"3499312111","isHighlighted":false,"author":{"name":"Gokhan Sagoglu","url":"","profileUrl":"","emailHash":"","avatar":{"small":{"permalink":"//a.disquscdn.com/1509064866/images/noavatar32.png","cache":"//a.disquscdn.com/1509064866/images/noavatar32.png"},"large":{"permalink":"//a.disquscdn.com/1509064866/images/noavatar92.png","cache":"//a.disquscdn.com/1509064866/images/noavatar92.png"},"permalink":"//a.disquscdn.com/1509064866/images/noavatar92.png","cache":"//a.disquscdn.com/1509064866/images/noavatar92.png"},"signedUrl":"","isAnonymous":true},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-01-29T18:13:36","parent":3499312075,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"You right, I forgot to add /c. I updated the post.\n\nParameter /b not only shows file/folder name, it also shows their paths. I think it is useful when you only want to see file paths with no additional information.\n\nThanks.","canVote":false,"thread":"6115200593","forum":"pentestblog","depth":1,"points":0,"moderationLabels":["anonymous"],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Great Article!, but i have a dude, how do you get to autorun when u restart?, I need to add to programing jobs?, i was triying to reply ur attack, and I haven't had a goal.\u003c/p>","id":"3499312073","isHighlighted":false,"author":{"name":"scary1","url":"","profileUrl":"","emailHash":"","avatar":{"small":{"permalink":"//a.disquscdn.com/1509064866/images/noavatar32.png","cache":"//a.disquscdn.com/1509064866/images/noavatar32.png"},"large":{"permalink":"//a.disquscdn.com/1509064866/images/noavatar92.png","cache":"//a.disquscdn.com/1509064866/images/noavatar92.png"},"permalink":"//a.disquscdn.com/1509064866/images/noavatar92.png","cache":"//a.disquscdn.com/1509064866/images/noavatar92.png"},"signedUrl":"","isAnonymous":true},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-01-27T17:13:31","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Great Article!, but i have a dude, how do you get to autorun when u restart?, I need to add to programing jobs?, i was triying to reply ur attack, and I haven't had a goal.","canVote":false,"thread":"6115200593","forum":"pentestblog","depth":0,"points":0,"moderationLabels":["anonymous"],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>I only assumed that the vulnerable processes and services start automatically. You will often encounter this case.\u003c/p>","id":"3499312079","isHighlighted":false,"author":{"name":"Gokhan Sagoglu","url":"","profileUrl":"","emailHash":"","avatar":{"small":{"permalink":"//a.disquscdn.com/1509064866/images/noavatar32.png","cache":"//a.disquscdn.com/1509064866/images/noavatar32.png"},"large":{"permalink":"//a.disquscdn.com/1509064866/images/noavatar92.png","cache":"//a.disquscdn.com/1509064866/images/noavatar92.png"},"permalink":"//a.disquscdn.com/1509064866/images/noavatar92.png","cache":"//a.disquscdn.com/1509064866/images/noavatar92.png"},"signedUrl":"","isAnonymous":true},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-01-29T18:30:14","parent":3499312073,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"I only assumed that the vulnerable processes and services start automatically. You will often encounter this case.","canVote":false,"thread":"6115200593","forum":"pentestblog","depth":1,"points":0,"moderationLabels":["anonymous"],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Hi\u003c/p>\u003cp>I have a question regarding the Unquoted Service Paths vulnerability.\u003c/p>\u003cp>I created the ImagePath below.\u003c/p>\u003cp>C:\\Program Files (x86)\\RSUPPORT\\testService\\testService.exe\u003c/p>\u003cp>But there are no spaces. [ Except for Program Files (x86) ]\u003c/p>\u003cp>Is this a vulnerability?\u003c/p>","id":"3499312071","isHighlighted":false,"author":{"name":"hacker","url":"","profileUrl":"","emailHash":"","avatar":{"small":{"permalink":"//a.disquscdn.com/1509064866/images/noavatar32.png","cache":"//a.disquscdn.com/1509064866/images/noavatar32.png"},"large":{"permalink":"//a.disquscdn.com/1509064866/images/noavatar92.png","cache":"//a.disquscdn.com/1509064866/images/noavatar92.png"},"permalink":"//a.disquscdn.com/1509064866/images/noavatar92.png","cache":"//a.disquscdn.com/1509064866/images/noavatar92.png"},"signedUrl":"","isAnonymous":true},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-01-24T07:43:17","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Hi\n\nI have a question regarding the Unquoted Service Paths vulnerability.\n\nI created the ImagePath below.\n\nC:\\Program Files (x86)\\RSUPPORT\\testService\\testService.exe\n\nBut there are no spaces. [ Except for Program Files (x86) ]\n\nIs this a vulnerability?","canVote":false,"thread":"6115200593","forum":"pentestblog","depth":0,"points":0,"moderationLabels":["anonymous"],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>If the root(C:\\) directory has weak permissions for unprivileged users, the answer is yes. Because, in this case, Windows will look at the following paths in order:\u003c/p>\u003cp>\u003c/p>\u003cblockquote>\u003cbr>C:\\Program.exe\u003cbr>C:\\Program Files.exe\u003cbr>C:\\Program Files (x86)\\RSUPPORT\\testService\\testService.exe\u003cbr>\u003c/blockquote>\u003cp>\u003c/p>\u003cp>That means an unprivileged attacker may escalate their privileges by placing malicious \"Program.exe\" or \"Program Files.exe\" to the root directory.\u003c/p>","id":"3499312101","isHighlighted":false,"author":{"name":"Gokhan Sagoglu","url":"","profileUrl":"","emailHash":"","avatar":{"small":{"permalink":"//a.disquscdn.com/1509064866/images/noavatar32.png","cache":"//a.disquscdn.com/1509064866/images/noavatar32.png"},"large":{"permalink":"//a.disquscdn.com/1509064866/images/noavatar92.png","cache":"//a.disquscdn.com/1509064866/images/noavatar92.png"},"permalink":"//a.disquscdn.com/1509064866/images/noavatar92.png","cache":"//a.disquscdn.com/1509064866/images/noavatar92.png"},"signedUrl":"","isAnonymous":true},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-01-24T08:36:58","parent":3499312071,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"If the root(C:\\) directory has weak permissions for unprivileged users, the answer is yes. Because, in this case, Windows will look at the following paths in order:\n\n\u003cblockquote>\nC:\\Program.exe\nC:\\Program Files.exe\nC:\\Program Files (x86)\\RSUPPORT\\testService\\testService.exe\n\u003c/blockquote>\n\nThat means an unprivileged attacker may escalate their privileges by placing malicious \"Program.exe\" or \"Program Files.exe\" to the root directory.","canVote":false,"thread":"6115200593","forum":"pentestblog","depth":1,"points":0,"moderationLabels":["anonymous"],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Hi.\u003c/p>\u003cp>I have additional questions about Unquoted Service Paths.\u003c/p>\u003cp>If the Everyone user has Full permission,\u003c/p>\u003cp>Can overwrite the Executable.exe file?\u003c/p>\u003cp>If possible,\u003c/p>\u003cp>Path to C:\\Program Files (x86)\\Program Folder\\A Subfolder\\\u003c/p>\u003cp>Is it possible to attack by uploading Executable.exe file?\u003c/p>\u003cp>Thank you for your help.\u003c/p>\u003cp>Your writing inspires me.\u003c/p>","id":"3499312259","isHighlighted":false,"author":{"name":"hacker","url":"","profileUrl":"","emailHash":"","avatar":{"small":{"permalink":"//a.disquscdn.com/1509064866/images/noavatar32.png","cache":"//a.disquscdn.com/1509064866/images/noavatar32.png"},"large":{"permalink":"//a.disquscdn.com/1509064866/images/noavatar92.png","cache":"//a.disquscdn.com/1509064866/images/noavatar92.png"},"permalink":"//a.disquscdn.com/1509064866/images/noavatar92.png","cache":"//a.disquscdn.com/1509064866/images/noavatar92.png"},"signedUrl":"","isAnonymous":true},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-01-25T11:00:31","parent":3499312101,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Hi.\n\nI have additional questions about Unquoted Service Paths.\n\nIf the Everyone user has Full permission,\n\nCan overwrite the Executable.exe file?\n\nIf possible,\n\nPath to C:\\Program Files (x86)\\Program Folder\\A Subfolder\\ \n\nIs it possible to attack by uploading Executable.exe file?\n\nThank you for your help.\n\nYour writing inspires me.","canVote":false,"thread":"6115200593","forum":"pentestblog","depth":2,"points":0,"moderationLabels":["anonymous"],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>It depends on the situation. If \u003cem>Executable.exe\u003c/em> has inherited permissions, it means \u003cem>Everyone\u003c/em> has \u003cem>Full Control\u003c/em> on this file. In this case, you can overwrite \u003cem>Executable.exe\u003c/em> file directly.\u003c/p>\u003cp>But, if \u003cem>Executable.exe\u003c/em> has explicit permissions it means their permissions are NOT propagated from the parent folder and there is no guarantee that you have right permissions to overwrite it. In such a case, you should use the technique that I mentioned in the post.\u003c/p>\u003cp>More information about explicit and inherited permissions can be found \u003ca href=\"http://disq.us/url?url=http%3A%2F%2Fwww.ntfs.com%2Fntfs-permissions-explicit.htm%3AD7rGei_V9YzZvsbmnqJSNyU6-Dc&amp;cuid=4765649\" rel=\"nofollow noopener\" title=\"http://www.ntfs.com/ntfs-permissions-explicit.htm\">here\u003c/a>.\u003c/p>\u003cp>Thanks for your comments, stay tuned!\u003c/p>","id":"3499312459","isHighlighted":false,"author":{"name":"Gokhan Sagoglu","url":"","profileUrl":"","emailHash":"","avatar":{"small":{"permalink":"//a.disquscdn.com/1509064866/images/noavatar32.png","cache":"//a.disquscdn.com/1509064866/images/noavatar32.png"},"large":{"permalink":"//a.disquscdn.com/1509064866/images/noavatar92.png","cache":"//a.disquscdn.com/1509064866/images/noavatar92.png"},"permalink":"//a.disquscdn.com/1509064866/images/noavatar92.png","cache":"//a.disquscdn.com/1509064866/images/noavatar92.png"},"signedUrl":"","isAnonymous":true},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-01-25T20:48:43","parent":3499312259,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"It depends on the situation. If \u003cem>Executable.exe\u003c/em> has inherited permissions, it means \u003cem>Everyone\u003c/em> has \u003cem>Full Control\u003c/em> on this file. In this case, you can overwrite \u003cem>Executable.exe\u003c/em> file directly.\n\nBut, if \u003cem>Executable.exe\u003c/em> has explicit permissions it means their permissions are NOT propagated from the parent folder and there is no guarantee that you have right permissions to overwrite it. In such a case, you should use the technique that I mentioned in the post.\n\nMore information about explicit and inherited permissions can be found \u003ca href=\"http://www.ntfs.com/ntfs-permissions-explicit.htm\" rel=\"nofollow\">here\u003c/a>.\n\nThanks for your comments, stay tuned!","canVote":false,"thread":"6115200593","forum":"pentestblog","depth":3,"points":0,"moderationLabels":["anonymous","links"],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Great article Gokhan, I'm definitely bookmarking this site :)\u003c/p>","id":"3499312066","isHighlighted":false,"author":{"name":"bookmarker","url":"http://nonefornow.com/","profileUrl":"","emailHash":"","avatar":{"small":{"permalink":"//a.disquscdn.com/1509064866/images/noavatar32.png","cache":"//a.disquscdn.com/1509064866/images/noavatar32.png"},"large":{"permalink":"//a.disquscdn.com/1509064866/images/noavatar92.png","cache":"//a.disquscdn.com/1509064866/images/noavatar92.png"},"permalink":"//a.disquscdn.com/1509064866/images/noavatar92.png","cache":"//a.disquscdn.com/1509064866/images/noavatar92.png"},"signedUrl":"http://disq.us/?url=http%3A%2F%2Fnonefornow.com%2F&key=X3C1bliHrSAFTNzstIDnNg","isAnonymous":true},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-01-19T15:31:30","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Great article Gokhan, I'm definitely bookmarking this site :)","canVote":false,"thread":"6115200593","forum":"pentestblog","depth":0,"points":0,"moderationLabels":["anonymous"],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Great job !  Your article is very valuable. \u003cbr>Could you provide the VM you used for this article ?\u003c/p>","id":"3499312060","isHighlighted":false,"author":{"name":"tar.gz","url":"","profileUrl":"","emailHash":"","avatar":{"small":{"permalink":"//a.disquscdn.com/1509064866/images/noavatar32.png","cache":"//a.disquscdn.com/1509064866/images/noavatar32.png"},"large":{"permalink":"//a.disquscdn.com/1509064866/images/noavatar92.png","cache":"//a.disquscdn.com/1509064866/images/noavatar92.png"},"permalink":"//a.disquscdn.com/1509064866/images/noavatar92.png","cache":"//a.disquscdn.com/1509064866/images/noavatar92.png"},"signedUrl":"","isAnonymous":true},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-01-19T10:52:28","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Great job !  Your article is very valuable. \nCould you provide the VM you used for this article ?","canVote":false,"thread":"6115200593","forum":"pentestblog","depth":0,"points":0,"moderationLabels":["anonymous"],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>I didn't use any vulnerable VM's, I just used one of my virtual machines by intentionally modifying it.\u003c/p>\u003cp>It's not that hard to modify the permission of a file, folder, registry key or service. :) I've already explained how to add a service that has unquoted service paths vulnerability, and I gave you a source code of tiny executable that has DLL hijacking vulnerability. I guess you have enough information to demonstrate them yourself. :)\u003c/p>","id":"3499312069","isHighlighted":false,"author":{"name":"Gokhan Sagoglu","url":"","profileUrl":"","emailHash":"","avatar":{"small":{"permalink":"//a.disquscdn.com/1509064866/images/noavatar32.png","cache":"//a.disquscdn.com/1509064866/images/noavatar32.png"},"large":{"permalink":"//a.disquscdn.com/1509064866/images/noavatar92.png","cache":"//a.disquscdn.com/1509064866/images/noavatar92.png"},"permalink":"//a.disquscdn.com/1509064866/images/noavatar92.png","cache":"//a.disquscdn.com/1509064866/images/noavatar92.png"},"signedUrl":"","isAnonymous":true},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-01-19T18:54:49","parent":3499312060,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"I didn't use any vulnerable VM's, I just used one of my virtual machines by intentionally modifying it.\n\nIt's not that hard to modify the permission of a file, folder, registry key or service. :) I've already explained how to add a service that has unquoted service paths vulnerability, and I gave you a source code of tiny executable that has DLL hijacking vulnerability. I guess you have enough information to demonstrate them yourself. :)","canVote":false,"thread":"6115200593","forum":"pentestblog","depth":1,"points":0,"moderationLabels":["anonymous"],"isEdited":false,"sb":false}],"thread":{"feed":"https://pentestblog.disqus.com/windows_privilege_escalation_methods_for_pentesters/latest.rss","author":"56267343","dislikes":0,"likes":0,"message":"","isSpam":false,"createdAt":"2017-09-02T20:01:41","category":"5980161","clean_title":"Windows Privilege Escalation Methods for Pentesters","id":"6115200593","signedLink":"https://disq.us/?url=https%3A%2F%2Fpentest.blog%2Fwindows-privilege-escalation-methods-for-pentesters%2F&key=esc_W5sfLbtSO8T-w5NQww","isDeleted":false,"hasStreaming":false,"raw_message":"","isClosed":false,"link":"https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/","slug":"windows_privilege_escalation_methods_for_pentesters","forum":"pentestblog","identifiers":["454 https://pentest.blog/?p=454"],"posts":24,"moderators":[264020658,264068130,56267343],"validateAllPosts":false,"title":"Windows Privilege Escalation Methods for Pentesters","highlightedPost":null}},"order":"popular"}</script>


    <div id="fixed-content"></div>


    
        
<script type="text/json" id="disqus-urls">{
    "root":"//disqus.com",
    "next":"https://c.disquscdn.com/next/current/embed"
}</script>

        
        <script>!function () {
            var d = document;
            var toH = d.head.appendChild.bind(d.head);

            var v = window.location.href.match(/[#&?]version=([0-9a-f]{32})/);
            var src = 'https://c.disquscdn.com/next/embed/lounge.load';
            if (v)
                src += '.' + v[1];
            src += '.js';

            var s = d.createElement('script');
            s.crossOrigin = 'anonymous';
            s.id = 'bootstrap-script';
            s.setAttribute('data-app', 'lounge');
            s.src = src;
            toH(s);

            var m = d.createElement('meta');
            m.setAttribute('http-equiv', 'Content-Security-Policy');
            m.setAttribute('content', "script-src https:;");
            toH(m);
        }();</script>
    


<script src="a_data/common.js"></script><div id="layout" data-tracking-area="layout"><div id="onboard" data-tracking-area="onboard"></div><div id="highlighted-post" data-tracking-area="highlighted" class="highlighted-post" style="display: none;"></div><div id="global-alert"></div><header id="main-nav" data-tracking-area="main-nav"><nav class="nav nav-primary"><ul><li class="nav-tab nav-tab--primary tab-conversation active" data-role="post-count"><a class="publisher-nav-color"><span class="comment-count">24 comments</span><span class="comment-count-placeholder">Comments</span></a></li><li class="nav-tab nav-tab--primary tab-community"><a href="https://disqus.com/home/forums/pentestblog/" class="publisher-nav-color" data-action="community-sidebar" data-forum="pentestblog" id="community-tab"><span class="community-name"><strong>Pentest Blog - Inn for security folks</strong></span><strong class="community-name-placeholder">Community</strong></a></li><li class="nav-tab nav-tab--primary dropdown user-menu" data-role="logout"><a href="#" class="dropdown-toggle" data-toggle="dropdown"><span class="dropdown-toggle-wrapper"><span>Login</span> </span> <span class="caret"></span></a><ul class="dropdown-menu"><li><a href="#" data-action="auth:disqus">Disqus</a></li><li><a href="#" data-action="auth:facebook">Facebook</a></li><li><a href="#" data-action="auth:twitter">Twitter</a></li><li><a href="#" data-action="auth:google">Google</a></li></ul></li><li class="nav-tab nav-tab--primary notification-menu unread" data-role="notification-menu"><a href="https://disqus.com/home/inbox/" class="notification-container" data-action="home" data-home-path="home/inbox/"><span class="notification-icon icon-comment" aria-hidden="true"></span><span class="notification-count" data-role="notification-count">1</span></a></li></ul></nav></header><section id="conversation" data-role="main" data-tracking-area="main"><div class="nav nav-secondary" data-tracking-area="secondary-nav"><ul><li id="recommend-button" class="nav-tab nav-tab--secondary recommend dropdown"><div class="thread-likes"><div><a href="#" data-action="recommend" title="Recommend this discussion" class="dropdown-toggle "><span class="label label-default"><span class="recommend-icon icon-heart-empty"></span> Recommend</span><span class="label label-recommended"><span class="recommend-icon icon-heart"></span> Recommended</span> </a><ul class="dropdown-menu dropdown-menu--coachmark"><li><div><h2 class="coachmark__heading">Discussion Recommended!</h2><p class="coachmark__description">Recommending means this is a discussion worth sharing. It gets shared to your followers' Disqus feeds, and gives the creator kudos!</p></div> <a href="https://disqus.com/home/?utm_source=disqus_embed&amp;utm_content=recommend_btn" class="btn btn-primary coachmark__button" target="_blank">Find More Discussions</a></li></ul></div></div></li><li id="thread-share-menu" class="nav-tab nav-tab--secondary dropdown share-menu hidden-sm"><a href="#" class="dropdown-toggle" data-toggle="dropdown" title="Share"><span class="icon-export"></span> <span class="label">Share</span></a><ul class="share-menu dropdown-menu"><li><div class="share-menu__label">Share this discussion on</div><ul><li class="twitter"><a data-action="share:twitter" href="#">Twitter</a></li><li class="facebook"><a data-action="share:facebook" href="#">Facebook</a></li></ul></li></ul></li><li data-role="post-sort" class="nav-tab nav-tab--secondary dropdown sorting pull-right"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Sort by Best<span class="caret"></span></a><ul class="dropdown-menu pull-right"><li class="selected"><a href="#" data-action="sort" data-sort="popular">Best<i aria-hidden="true" class="icon-checkmark"></i></a></li><li class=""><a href="#" data-action="sort" data-sort="desc">Newest<i aria-hidden="true" class="icon-checkmark"></i></a></li><li class=""><a href="#" data-action="sort" data-sort="asc">Oldest<i aria-hidden="true" class="icon-checkmark"></i></a></li></ul></li></ul></div><div id="posts"><div id="form" class="textarea-wrapper--top-level"><form class="reply"><div class="postbox"><div role="alert"></div><div class="avatar"><span class="user"><img data-role="user-avatar" src="a_data/noavatar92_002.png" alt="Avatar"></span></div><div class="textarea-wrapper" data-role="textarea" dir="auto"><div><span class="placeholder">Join the discussion…</span><div class="textarea" tabindex="0" role="textbox" aria-multiline="true" data-role="editable" style="overflow: auto; overflow-wrap: break-word; max-height: 350px;" aria-label="Join the discussion…" contenteditable="true"><p><br></p></div><div style="display: none;"><ul class="user-mention__list"><li class="header user-mention__header"><h5>in this conversation</h5></li></ul></div></div><div data-role="drag-drop-placeholder" class="media-drag-hover" style="display: none;"><div class="drag-text">⬇ Drag and drop your images here to upload them.</div></div><div class="media-preview empty" data-role="media-preview"><ul data-role="media-progress-list"></ul>
<ul data-role="media-rich-list"></ul>
<div class="media-expanded empty" data-role="media-preview-expanded">
<img src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" data-role="media-preview-expanded-image" alt="Media preview placeholder">
</div>
</div><div class="edit-alert" role="postbox-alert"></div><div class="post-actions"><ul class="wysiwyg"><li class="wysiwyg__item" data-role="media-uploader"><a href="#" tabindex="-1" data-action="attach" class="attach" title="Upload Images"><span>Attach</span></a>
<input data-role="media-upload" tabindex="-1" accept="image/*" type="file">
</li></ul></div></div><div data-role="login-form"><div><div><section class="auth-section logged-out"><div class="connect"><h6>Log in with</h6><ul data-role="login-menu" class="services login-buttons"><li class="auth-disqus"><button type="button" data-action="auth:disqus" title="Disqus" class="connect__button"><i class="icon-disqus"></i></button></li><li class="auth-facebook"><button type="button" data-action="auth:facebook" title="Facebook" class="connect__button"><i class="icon-facebook-circle"></i></button></li><li class="auth-twitter"><button type="button" data-action="auth:twitter" title="Twitter" class="connect__button"><i class="icon-twitter-circle"></i></button></li><li class="auth-google"><button type="button" data-action="auth:google" title="Google" class="connect__button"><i class="icon-google-plus-circle"></i></button></li></ul></div><div class="guest"><h6 class="guest-form-title"><span class="register-text"> or sign up with Disqus </span><span class="guest-text"> or pick a name </span></h6> <div class="help-tooltip__wrapper help-icon" tabindex="0"><div id="rules" class="tooltip show help-tooltip"><h3 class="help-tooltip__heading">Disqus is a discussion network</h3><ul class="help-tooltip__list"><li><span>Disqus never moderates or censors. The rules on this community are its own.</span></li><li><span>Don't be a jerk or do anything illegal. Everything is easier that way.</span></li></ul><p class="clearfix"><a href="https://docs.disqus.com/kb/terms-and-policies/" class="btn btn-small help-tooltip__button" target="_blank">Read full terms and conditions</a></p></div></div><p class="input-wrapper"><input dir="auto" placeholder="Name" name="display_name" id="view79_display_name" maxlength="30" class="input--text" type="text"></p><div class="guest-details " data-role="guest-details"><p class="input-wrapper"><input dir="auto" placeholder="Email" name="email" id="view79_email" class="input--text" type="email"></p><p class="input-wrapper"><input dir="auto" disabled="disabled" class="register-text input--text" placeholder="Password" name="password" id="view79_password" type="text"></p><div class="acceptance-wrapper register-text">By signing up, you agree to the Disqus <a href="https://help.disqus.com/customer/portal/articles/1753105-basic-rules-for-disqus-powered-profiles-and-discussions" target="_blank">Basic Rules</a>, <a href="https://help.disqus.com/customer/portal/articles/466260-terms-of-service" target="_blank">Terms of Service</a>, and <a href="https://help.disqus.com/customer/portal/articles/466259-privacy-policy" target="_blank">Privacy Policy</a>.</div><div class="acceptance-wrapper guest-text">By posting, you agree to the Disqus <a href="https://help.disqus.com/customer/portal/articles/1753105-basic-rules-for-disqus-powered-profiles-and-discussions" target="_blank">Basic Rules</a>, <a href="https://help.disqus.com/customer/portal/articles/466260-terms-of-service" target="_blank">Terms of Service</a>, and <a href="https://help.disqus.com/customer/portal/articles/466259-privacy-policy" target="_blank">Privacy Policy</a>.</div><div class="guest-checkbox"><label><input name="author-guest" type="checkbox"> I'd rather post as a guest</label></div><div class="proceed" data-role="submit-btn-container"><div><button type="submit" class="proceed__button btn submit" aria-label="Post"><span class="icon-proceed"></span><div class="spinner"></div></button><button type="submit" class="proceed__button btn next" aria-label="Next"><span class="icon-proceed"></span><div class="spinner"></div></button></div></div></div></div></section></div></div></div></div></form></div><button class="alert alert--realtime" style="display: none;" data-role="realtime-notification"></button><div id="no-posts" style="display: none;"></div><ul id="post-list" class="post-list"><li class="post" id="post-3576011818"><div role="alert"></div><div data-role="post-content" class="post-content"><div class="indicator"></div><div class="avatar"><div class="user"><img src="a_data/noavatar92.png" class="user" alt="Avatar"></div></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span class="author">qdqdqsdsq</span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/#comment-3576011818" data-role="relative-time" class="time-ago" title="Friday, October 20, 2017 9:59 AM">13 days ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Brilliant article , favorited<br>I
 dont agree with this '|findstr /i "Auto"' in the first technique. If I m
 correct you can hijack automaticaly started service, if their path is 
vulnerable. Why would you remove them from the list ?</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></span></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/1n52cdm"></li></ul></li><li class="realtime" data-role="realtime-notification:3576011818"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand"><span>+</span></a></li><li class="" role="menu"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"><li class="post" id="post-3583800976"><div role="alert"></div><div data-role="post-content" class="post-content"><div class="indicator"></div><div class="avatar hovercard"><a href="https://disqus.com/by/gokhansagoglu/" data-action="profile" data-username="gokhansagoglu" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="264020658" src="a_data/noavatar92.png" data-src="https://c.disquscdn.com/uploads/users/26402/658/avatar92.jpg?1508932973" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/gokhansagoglu/" data-action="profile" data-username="gokhansagoglu" target="_blank" rel="noopener noreferrer">Gokhan Sagoglu</a></span> <span class="badge moderator">Ninja</span></span><span> <a href="https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/#comment-3576011818" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> qdqdqsdsq</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/#comment-3583800976" data-role="relative-time" class="time-ago" title="Wednesday, October 25, 2017 1:02 PM">8 days ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>I
 didn't get your question. Yes, we are trying to list automatically 
started vulnerable services. That's why we use '|findstr /i "Auto"'.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></span></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/1n9paj4"></li></ul></li><li class="realtime" data-role="realtime-notification:3583800976"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand"><span>+</span></a></li><li class="" role="menu"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"></ul></li></ul></li><li class="post" id="post-3558064823"><div role="alert"></div><div data-role="post-content" class="post-content"><div class="indicator"></div><div class="avatar hovercard"><a href="https://disqus.com/by/xiaohangyu/" data-action="profile" data-username="xiaohangyu" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="238616732" src="a_data/noavatar92.png" data-src="//a.disquscdn.com/1509064866/images/noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/xiaohangyu/" data-action="profile" data-username="xiaohangyu" target="_blank" rel="noopener noreferrer">Xiaohang Yu</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/#comment-3558064823" data-role="relative-time" class="time-ago" title="Monday, October 9, 2017 5:07 AM">24 days ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Fantastic! I love this post. Narrated it so clearly. I learned a lot! Bookmarked.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></span></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/1mudodz"></li></ul></li><li class="realtime" data-role="realtime-notification:3558064823"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand"><span>+</span></a></li><li class="" role="menu"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"></ul></li><li class="post" id="post-3499312098"><div role="alert"></div><div data-role="post-content" class="post-content"><div class="indicator"></div><div class="avatar"><div class="user"><img src="a_data/noavatar92.png" class="user" alt="Avatar"></div></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span class="author">Christophe</span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/#comment-3499312098" data-role="relative-time" class="time-ago" title="Thursday, August 31, 2017 4:41 PM">2 months ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Awesome post, thank you! Bookmarked.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></span></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/1lveehu"></li></ul></li><li class="realtime" data-role="realtime-notification:3499312098"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand"><span>+</span></a></li><li class="" role="menu"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"></ul></li><li class="post" id="post-3499312096"><div role="alert"></div><div data-role="post-content" class="post-content"><div class="indicator"></div><div class="avatar"><div class="user"><img src="a_data/noavatar92.png" class="user" alt="Avatar"></div></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span class="author">PlainText</span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/#comment-3499312096" data-role="relative-time" class="time-ago" title="Wednesday, August 9, 2017 2:33 PM">3 months ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Thanks for taking the time to wrote this article, very helpful! I'm your follower now :)</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></span></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/1lveehs"></li></ul></li><li class="realtime" data-role="realtime-notification:3499312096"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand"><span>+</span></a></li><li class="" role="menu"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"></ul></li><li class="post" id="post-3499312091"><div role="alert"></div><div data-role="post-content" class="post-content"><div class="indicator"></div><div class="avatar"><div class="user"><img src="a_data/noavatar92.png" class="user" alt="Avatar"></div></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span class="author">Ibrahim</span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/#comment-3499312091" data-role="relative-time" class="time-ago" title="Saturday, June 10, 2017 4:47 PM">5 months ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Hi, one the best guides out there ;)</p><p>Two things: <br>1. on the command below, you need to modify the start=auto to start= auto (space after the equal sign).<br>C:\Windows\System32&gt;sc
 create "Vulnerable Service" binPath= "C:\Program Files (x86)\Program 
Folder\A Subfolder\Executable.exe" start= auto</p><p>2. I tried to 
follow the insecure registery file path mofication and the service path 
modification, but it gives me errors about access denied when I use the 
SubInACL  or the sc config command.</p><p>Would you be so kind and tell how to prepare the vulnerable service in order to simulate a successfull attack on lab?</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></span></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/1lveehn"></li></ul></li><li class="realtime" data-role="realtime-notification:3499312091"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand"><span>+</span></a></li><li class="" role="menu"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"><li class="post" id="post-3499312142"><div role="alert"></div><div data-role="post-content" class="post-content"><div class="indicator"></div><div class="avatar"><div class="user"><img src="a_data/noavatar92.png" class="user" alt="Avatar"></div></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span class="author">Gokhan Sagoglu</span><span> <a href="https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/#comment-3499312091" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Ibrahim</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/#comment-3499312142" data-role="relative-time" class="time-ago" title="Sunday, June 11, 2017 4:01 PM">5 months ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>1.
 Adding space after equal sign is unnecessary. Command works fine in 
this way. But it may vary depending on the operating system version. 
Which version of Windows are you using?</p><p>2. If you want to modify a
 registry value with unprivileged user, the registry key should has 
proper permissions. You may consider simply granting full control for 
everyone:</p><p><em>subinacl /subkeyreg "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Vulnerable Service" /grant=Everyone=F</em></p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></span></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/1lveej2"></li></ul></li><li class="realtime" data-role="realtime-notification:3499312142"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand"><span>+</span></a></li><li class="" role="menu"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"><li class="post" id="post-3499312264"><div role="alert"></div><div data-role="post-content" class="post-content"><div class="indicator"></div><div class="avatar"><div class="user"><img src="a_data/noavatar92.png" class="user" alt="Avatar"></div></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span class="author">Ibrahim</span><span> <a href="https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/#comment-3499312142" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Gokhan Sagoglu</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/#comment-3499312264" data-role="relative-time" class="time-ago" title="Sunday, June 11, 2017 9:27 PM">5 months ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>1. I used Windows 7 Ultimate 32-bit in my lab. I will give it a try on other old and recent releases.<br>2. I will do so by using the provided command :).</p><p>Thanks for the reply.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></span></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/1lveemg"></li></ul></li><li class="realtime" data-role="realtime-notification:3499312264"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand"><span>+</span></a></li><li class="" role="menu"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"></ul></li></ul></li></ul></li><li class="post" id="post-3499312087"><div role="alert"></div><div data-role="post-content" class="post-content"><div class="indicator"></div><div class="avatar"><div class="user"><img src="a_data/noavatar92.png" class="user" alt="Avatar"></div></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span class="author">Dario Ackermann</span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/#comment-3499312087" data-role="relative-time" class="time-ago" title="Tuesday, April 25, 2017 5:16 PM">6 months ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Hey,<br>I've got a question. Tried the first one to get the privileges!</p><p>The vulnerable path is `C:\Program Files (x86)\ASUS\ATK Package\ATK Hotkey\AsLdrSrv.exe`<br>So I tried placing a file `C:\Program Files (x86)\ASUS\ATK Package\ATK Hotkey.exe`</p><p>But it actually doesn't work. Am I doing something wrong?</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></span></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/1lveehj"></li></ul></li><li class="realtime" data-role="realtime-notification:3499312087"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand"><span>+</span></a></li><li class="" role="menu"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"><li class="post" id="post-3499312110"><div role="alert"></div><div data-role="post-content" class="post-content"><div class="indicator"></div><div class="avatar"><div class="user"><img src="a_data/noavatar92.png" class="user" alt="Avatar"></div></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span class="author">Gokhan Sagoglu</span><span> <a href="https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/#comment-3499312087" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Dario Ackermann</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/#comment-3499312110" data-role="relative-time" class="time-ago" title="Tuesday, April 25, 2017 6:14 PM">6 months ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>You're doing it wrong. You should place the executable to one of these paths:<br><em>C:\Program Files (x86)\ASUS\ATK Package\ATK.exe</em><br><em>C:\Program Files (x86)\ASUS\ATK.exe</em><br><em>C:\Program Files.exe</em><br><em>C:\Program.exe</em></p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></span></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/1lveei6"></li></ul></li><li class="realtime" data-role="realtime-notification:3499312110"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand"><span>+</span></a></li><li class="" role="menu"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"></ul></li></ul></li><li class="post" id="post-3499312080"><div role="alert"></div><div data-role="post-content" class="post-content"><div class="indicator"></div><div class="avatar"><div class="user"><img src="a_data/noavatar92.png" class="user" alt="Avatar"></div></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span class="author">fahad</span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/#comment-3499312080" data-role="relative-time" class="time-ago" title="Tuesday, March 7, 2017 10:48 AM">8 months ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Great Article !<br>I
 have one question, how would you query the registry for all services 
with Insecure Registry Permissions ? In the example you already know 
about the weak one.<br>Regards,</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></span></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/1lveehc"></li></ul></li><li class="realtime" data-role="realtime-notification:3499312080"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand"><span>+</span></a></li><li class="" role="menu"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"><li class="post" id="post-3499312086"><div role="alert"></div><div data-role="post-content" class="post-content"><div class="indicator"></div><div class="avatar"><div class="user"><img src="a_data/noavatar92.png" class="user" alt="Avatar"></div></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span class="author">Gokhan Sagoglu</span><span> <a href="https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/#comment-3499312080" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> fahad</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/#comment-3499312086" data-role="relative-time" class="time-ago" title="Thursday, March 9, 2017 3:55 PM">8 months ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Instead of typing service name you should put "*" for listing all service's permissions:</p><p><code>subinacl.exe /keyreg "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\*" /display</code></p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></span></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/1lveehi"></li></ul></li><li class="realtime" data-role="realtime-notification:3499312086"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand"><span>+</span></a></li><li class="" role="menu"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"></ul></li></ul></li><li class="post" id="post-3499312082"><div role="alert"></div><div data-role="post-content" class="post-content"><div class="indicator"></div><div class="avatar"><div class="user"><img src="a_data/noavatar92.png" class="user" alt="Avatar"></div></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span class="author">Decoder</span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/#comment-3499312082" data-role="relative-time" class="time-ago" title="Friday, February 24, 2017 5:54 PM">8 months ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Hello!<br>You
 forgot to mention that the first low-privileged meterpreter shell has  
to be launched from an interactive session (cmd.exe on remote computer) 
otherwise it won't work.  For example, if you launch it from an 
xp_cmdshell obtained by an SQLi , you will get this message: <br>"The Windows Installer Service could not be accessed. <br>This can occur if the Windows Installer is not correctly installed. <br>Contact your support personnel for assistance."<br>And the detailed  log will tell you why:<br>"Client-side and UI is none or basic: Running entire install on the server."<br>I wrote a similar article on my blog: <a href="https://disq.us/url?url=https%3A%2F%2Fdecoder.cloud%3AGiudZOepwPLTlnj_FHaxnUUMH70&amp;cuid=4765649" rel="nofollow noopener" title="https://decoder.cloud">https://decoder.cloud</a></p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></span></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/1lveehe"></li></ul></li><li class="realtime" data-role="realtime-notification:3499312082"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand"><span>+</span></a></li><li class="" role="menu"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"></ul></li><li class="post" id="post-3499312075"><div role="alert"></div><div data-role="post-content" class="post-content"><div class="indicator"></div><div class="avatar"><div class="user"><img src="a_data/noavatar92.png" class="user" alt="Avatar"></div></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span class="author">Leo</span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/#comment-3499312075" data-role="relative-time" class="time-ago" title="Friday, January 27, 2017 7:50 PM">9 months ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>you use dir without /a, therefore, you miss hidden/system files and folders</p><p>to make sure they are included in search it should be dir c:\*vnc.ini /s /b /a</p><p>but
 there's another thing, you use /b, therefore in your output you will 
have a file name (check if exists, basically), but you won't have a 
directory it resides in, making the search useless, so I suggest to omit
 /b</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></span></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/1lveeh7"></li></ul></li><li class="realtime" data-role="realtime-notification:3499312075"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand"><span>+</span></a></li><li class="" role="menu"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"><li class="post" id="post-3499312111"><div role="alert"></div><div data-role="post-content" class="post-content"><div class="indicator"></div><div class="avatar"><div class="user"><img src="a_data/noavatar92.png" class="user" alt="Avatar"></div></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span class="author">Gokhan Sagoglu</span><span> <a href="https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/#comment-3499312075" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Leo</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/#comment-3499312111" data-role="relative-time" class="time-ago" title="Sunday, January 29, 2017 6:13 PM">9 months ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>You right, I forgot to add /c. I updated the post.</p><p>Parameter
 /b not only shows file/folder name, it also shows their paths. I think 
it is useful when you only want to see file paths with no additional 
information.</p><p>Thanks.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></span></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/1lveei7"></li></ul></li><li class="realtime" data-role="realtime-notification:3499312111"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand"><span>+</span></a></li><li class="" role="menu"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"></ul></li></ul></li><li class="post" id="post-3499312073"><div role="alert"></div><div data-role="post-content" class="post-content"><div class="indicator"></div><div class="avatar"><div class="user"><img src="a_data/noavatar92.png" class="user" alt="Avatar"></div></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span class="author">scary1</span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/#comment-3499312073" data-role="relative-time" class="time-ago" title="Friday, January 27, 2017 5:13 PM">9 months ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Great
 Article!, but i have a dude, how do you get to autorun when u restart?,
 I need to add to programing jobs?, i was triying to reply ur attack, 
and I haven't had a goal.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></span></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/1lveeh5"></li></ul></li><li class="realtime" data-role="realtime-notification:3499312073"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand"><span>+</span></a></li><li class="" role="menu"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"><li class="post" id="post-3499312079"><div role="alert"></div><div data-role="post-content" class="post-content"><div class="indicator"></div><div class="avatar"><div class="user"><img src="a_data/noavatar92.png" class="user" alt="Avatar"></div></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span class="author">Gokhan Sagoglu</span><span> <a href="https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/#comment-3499312073" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> scary1</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/#comment-3499312079" data-role="relative-time" class="time-ago" title="Sunday, January 29, 2017 6:30 PM">9 months ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>I only assumed that the vulnerable processes and services start automatically. You will often encounter this case.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></span></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/1lveehb"></li></ul></li><li class="realtime" data-role="realtime-notification:3499312079"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand"><span>+</span></a></li><li class="" role="menu"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"></ul></li></ul></li><li class="post" id="post-3499312071"><div role="alert"></div><div data-role="post-content" class="post-content"><div class="indicator"></div><div class="avatar"><div class="user"><img src="a_data/noavatar92.png" class="user" alt="Avatar"></div></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span class="author">hacker</span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/#comment-3499312071" data-role="relative-time" class="time-ago" title="Tuesday, January 24, 2017 7:43 AM">9 months ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Hi</p><p>I have a question regarding the Unquoted Service Paths vulnerability.</p><p>I created the ImagePath below.</p><p>C:\Program Files (x86)\RSUPPORT\testService\testService.exe</p><p>But there are no spaces. [ Except for Program Files (x86) ]</p><p>Is this a vulnerability?</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></span></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/1lveeh3"></li></ul></li><li class="realtime" data-role="realtime-notification:3499312071"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand"><span>+</span></a></li><li class="" role="menu"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"><li class="post" id="post-3499312101"><div role="alert"></div><div data-role="post-content" class="post-content"><div class="indicator"></div><div class="avatar"><div class="user"><img src="a_data/noavatar92.png" class="user" alt="Avatar"></div></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span class="author">Gokhan Sagoglu</span><span> <a href="https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/#comment-3499312071" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> hacker</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/#comment-3499312101" data-role="relative-time" class="time-ago" title="Tuesday, January 24, 2017 8:36 AM">9 months ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>If
 the root(C:\) directory has weak permissions for unprivileged users, 
the answer is yes. Because, in this case, Windows will look at the 
following paths in order:</p><p></p><blockquote><br>C:\Program.exe<br>C:\Program Files.exe<br>C:\Program Files (x86)\RSUPPORT\testService\testService.exe<br></blockquote><p></p><p>That
 means an unprivileged attacker may escalate their privileges by placing
 malicious "Program.exe" or "Program Files.exe" to the root directory.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></span></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/1lveehx"></li></ul></li><li class="realtime" data-role="realtime-notification:3499312101"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand"><span>+</span></a></li><li class="" role="menu"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"><li class="post" id="post-3499312259"><div role="alert"></div><div data-role="post-content" class="post-content"><div class="indicator"></div><div class="avatar"><div class="user"><img src="a_data/noavatar92.png" class="user" alt="Avatar"></div></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span class="author">hacker</span><span> <a href="https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/#comment-3499312101" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Gokhan Sagoglu</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/#comment-3499312259" data-role="relative-time" class="time-ago" title="Wednesday, January 25, 2017 11:00 AM">9 months ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Hi.</p><p>I have additional questions about Unquoted Service Paths.</p><p>If the Everyone user has Full permission,</p><p>Can overwrite the Executable.exe file?</p><p>If possible,</p><p>Path to C:\Program Files (x86)\Program Folder\A Subfolder\</p><p>Is it possible to attack by uploading Executable.exe file?</p><p>Thank you for your help.</p><p>Your writing inspires me.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></span></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/1lveemb"></li></ul></li><li class="realtime" data-role="realtime-notification:3499312259"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand"><span>+</span></a></li><li class="" role="menu"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"><li class="post" id="post-3499312459"><div role="alert"></div><div data-role="post-content" class="post-content"><div class="indicator"></div><div class="avatar"><div class="user"><img src="a_data/noavatar92.png" class="user" alt="Avatar"></div></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span class="author">Gokhan Sagoglu</span><span> <a href="https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/#comment-3499312259" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> hacker</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/#comment-3499312459" data-role="relative-time" class="time-ago" title="Wednesday, January 25, 2017 8:48 PM">9 months ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>It depends on the situation. If <em>Executable.exe</em> has inherited permissions, it means <em>Everyone</em> has <em>Full Control</em> on this file. In this case, you can overwrite <em>Executable.exe</em> file directly.</p><p>But, if <em>Executable.exe</em>
 has explicit permissions it means their permissions are NOT propagated 
from the parent folder and there is no guarantee that you have right 
permissions to overwrite it. In such a case, you should use the 
technique that I mentioned in the post.</p><p>More information about explicit and inherited permissions can be found <a href="http://disq.us/url?url=http%3A%2F%2Fwww.ntfs.com%2Fntfs-permissions-explicit.htm%3AD7rGei_V9YzZvsbmnqJSNyU6-Dc&amp;cuid=4765649" rel="nofollow noopener" title="http://www.ntfs.com/ntfs-permissions-explicit.htm">here</a>.</p><p>Thanks for your comments, stay tuned!</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></span></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/1lveerv"></li></ul></li><li class="realtime" data-role="realtime-notification:3499312459"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand"><span>+</span></a></li><li class="" role="menu"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"></ul></li></ul></li></ul></li></ul></li><li class="post" id="post-3499312066"><div role="alert"></div><div data-role="post-content" class="post-content"><div class="indicator"></div><div class="avatar"><div class="user"><img src="a_data/noavatar92.png" class="user" alt="Avatar"></div></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span class="author">bookmarker</span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/#comment-3499312066" data-role="relative-time" class="time-ago" title="Thursday, January 19, 2017 3:31 PM">9 months ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Great article Gokhan, I'm definitely bookmarking this site :)</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></span></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/1lveegy"></li></ul></li><li class="realtime" data-role="realtime-notification:3499312066"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand"><span>+</span></a></li><li class="" role="menu"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"></ul></li><li class="post" id="post-3499312060"><div role="alert"></div><div data-role="post-content" class="post-content"><div class="indicator"></div><div class="avatar"><div class="user"><img src="a_data/noavatar92.png" class="user" alt="Avatar"></div></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span class="author">tar.gz</span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/#comment-3499312060" data-role="relative-time" class="time-ago" title="Thursday, January 19, 2017 10:52 AM">9 months ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Great job !  Your article is very valuable. <br>Could you provide the VM you used for this article ?</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></span></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/1lveegs"></li></ul></li><li class="realtime" data-role="realtime-notification:3499312060"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand"><span>+</span></a></li><li class="" role="menu"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"><li class="post" id="post-3499312069"><div role="alert"></div><div data-role="post-content" class="post-content"><div class="indicator"></div><div class="avatar"><div class="user"><img src="a_data/noavatar92.png" class="user" alt="Avatar"></div></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span class="author">Gokhan Sagoglu</span><span> <a href="https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/#comment-3499312060" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> tar.gz</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/#comment-3499312069" data-role="relative-time" class="time-ago" title="Thursday, January 19, 2017 6:54 PM">9 months ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>I didn't use any vulnerable VM's, I just used one of my virtual machines by intentionally modifying it.</p><p>It's
 not that hard to modify the permission of a file, folder, registry key 
or service. :) I've already explained how to add a service that has 
unquoted service paths vulnerability, and I gave you a source code of 
tiny executable that has DLL hijacking vulnerability. I guess you have 
enough information to demonstrate them yourself. :)</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></span></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/1lveeh1"></li></ul></li><li class="realtime" data-role="realtime-notification:3499312069"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand"><span>+</span></a></li><li class="" role="menu"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"></ul></li></ul></li></ul><div class="load-more" data-role="more" style="display: none;"><a href="#" data-action="more-posts" class="btn load-more__button">Load more comments</a></div></div></section><div id="placement-bottom" data-tracking-area="discovery-south"></div><div id="footer" data-tracking-area="footer" class="disqus-footer__wrapper"><ul class="disqus-footer"><li class="disqus-footer__logo"><a href="https://disqus.com/" rel="nofollow" title="Powered by Disqus" class="disqus-footer__link">Powered by Disqus</a></li><li id="thread-subscribe-button" class="email disqus-footer__item"><div class="default"><a href="#" rel="nofollow" data-action="subscribe" title="Subscribe and get email updates from this discussion" class="disqus-footer__link"><i aria-hidden="true" class="icon icon-mail"></i><span class="clip">Subscribe</span><i aria-hidden="true" class="icon icon-checkmark"></i></a></div></li><li class="install disqus-footer__item"><a href="https://publishers.disqus.com/engage?utm_source=pentestblog&amp;utm_medium=Disqus-Footer" rel="nofollow" target="_blank" class="disqus-footer__link"><i aria-hidden="true" class="icon icon-disqus"></i><span class="clip hidden-sm">Add Disqus to your site</span><span class="clip visible-sm hidden-xs">Add Disqus</span><span class="clip visible-xs">Add</span></a></li><li class="privacy disqus-footer__item"><a href="https://help.disqus.com/customer/portal/articles/466259-privacy-policy" rel="nofollow" target="_blank" class="disqus-footer__link"><i aria-hidden="true" class="icon icon-lock"></i><span class="clip">Privacy</span></a></li></ul></div></div></body></html>